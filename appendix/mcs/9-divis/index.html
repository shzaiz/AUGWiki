
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../8-infset/">
      
      
        <link rel="next" href="../10-gra-part/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.32">
    
    
      
        <title>9 整除性 - AUG's Lecture Notes</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.3cba04c6.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      
  
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
  
  <style>:root{--md-admonition-icon--note:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M1 7.775V2.75C1 1.784 1.784 1 2.75 1h5.025c.464 0 .91.184 1.238.513l6.25 6.25a1.75 1.75 0 0 1 0 2.474l-5.026 5.026a1.75 1.75 0 0 1-2.474 0l-6.25-6.25A1.752 1.752 0 0 1 1 7.775Zm1.5 0c0 .066.026.13.073.177l6.25 6.25a.25.25 0 0 0 .354 0l5.025-5.025a.25.25 0 0 0 0-.354l-6.25-6.25a.25.25 0 0 0-.177-.073H2.75a.25.25 0 0 0-.25.25ZM6 5a1 1 0 1 1 0 2 1 1 0 0 1 0-2Z"/></svg>');--md-admonition-icon--abstract:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M2.5 1.75v11.5c0 .138.112.25.25.25h3.17a.75.75 0 0 1 0 1.5H2.75A1.75 1.75 0 0 1 1 13.25V1.75C1 .784 1.784 0 2.75 0h8.5C12.216 0 13 .784 13 1.75v7.736a.75.75 0 0 1-1.5 0V1.75a.25.25 0 0 0-.25-.25h-8.5a.25.25 0 0 0-.25.25Zm13.274 9.537v-.001l-4.557 4.45a.75.75 0 0 1-1.055-.008l-1.943-1.95a.75.75 0 0 1 1.062-1.058l1.419 1.425 4.026-3.932a.75.75 0 1 1 1.048 1.074ZM4.75 4h4.5a.75.75 0 0 1 0 1.5h-4.5a.75.75 0 0 1 0-1.5ZM4 7.75A.75.75 0 0 1 4.75 7h2a.75.75 0 0 1 0 1.5h-2A.75.75 0 0 1 4 7.75Z"/></svg>');--md-admonition-icon--definition:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8Zm8-6.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13ZM6.5 7.75A.75.75 0 0 1 7.25 7h1a.75.75 0 0 1 .75.75v2.75h.25a.75.75 0 0 1 0 1.5h-2a.75.75 0 0 1 0-1.5h.25v-2h-.25a.75.75 0 0 1-.75-.75ZM8 6a1 1 0 1 1 0-2 1 1 0 0 1 0 2Z"/></svg>');--md-admonition-icon--tip:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M3.499.75a.75.75 0 0 1 1.5 0v.996C5.9 2.903 6.793 3.65 7.662 4.376l.24.202c-.036-.694.055-1.422.426-2.163C9.1.873 10.794-.045 12.622.26 14.408.558 16 1.94 16 4.25c0 1.278-.954 2.575-2.44 2.734l.146.508.065.22c.203.701.412 1.455.476 2.226.142 1.707-.4 3.03-1.487 3.898C11.714 14.671 10.27 15 8.75 15h-6a.75.75 0 0 1 0-1.5h1.376a4.484 4.484 0 0 1-.563-1.191 3.835 3.835 0 0 1-.05-2.063 4.647 4.647 0 0 1-2.025-.293.75.75 0 0 1 .525-1.406c1.357.507 2.376-.006 2.698-.318l.009-.01a.747.747 0 0 1 1.06 0 .748.748 0 0 1-.012 1.074c-.912.92-.992 1.835-.768 2.586.221.74.745 1.337 1.196 1.621H8.75c1.343 0 2.398-.296 3.074-.836.635-.507 1.036-1.31.928-2.602-.05-.603-.216-1.224-.422-1.93l-.064-.221c-.12-.407-.246-.84-.353-1.29a2.425 2.425 0 0 1-.507-.441 3.075 3.075 0 0 1-.633-1.248.75.75 0 0 1 1.455-.364c.046.185.144.436.31.627.146.168.353.305.712.305.738 0 1.25-.615 1.25-1.25 0-1.47-.95-2.315-2.123-2.51-1.172-.196-2.227.387-2.706 1.345-.46.92-.27 1.774.019 3.062l.042.19a.884.884 0 0 1 .01.05c.348.443.666.949.94 1.553a.75.75 0 1 1-1.365.62c-.553-1.217-1.32-1.94-2.3-2.768L6.7 5.527c-.814-.68-1.75-1.462-2.692-2.619a3.737 3.737 0 0 0-1.023.88c-.406.495-.663 1.036-.722 1.508.116.122.306.21.591.239.388.038.797-.06 1.032-.19a.75.75 0 0 1 .728 1.31c-.515.287-1.23.439-1.906.373-.682-.067-1.473-.38-1.879-1.193L.75 5.677V5.5c0-.984.48-1.94 1.077-2.664.46-.559 1.05-1.055 1.673-1.353V.75Z"/></svg>');--md-admonition-icon--success:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"/></svg>');--md-admonition-icon--question:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8Zm8-6.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13ZM6.92 6.085h.001a.749.749 0 1 1-1.342-.67c.169-.339.436-.701.849-.977C6.845 4.16 7.369 4 8 4a2.756 2.756 0 0 1 1.637.525c.503.377.863.965.863 1.725 0 .448-.115.83-.329 1.15-.205.307-.47.513-.692.662-.109.072-.22.138-.313.195l-.006.004a6.24 6.24 0 0 0-.26.16.952.952 0 0 0-.276.245.75.75 0 0 1-1.248-.832c.184-.264.42-.489.692-.661.103-.067.207-.132.313-.195l.007-.004c.1-.061.182-.11.258-.161a.969.969 0 0 0 .277-.245C8.96 6.514 9 6.427 9 6.25a.612.612 0 0 0-.262-.525A1.27 1.27 0 0 0 8 5.5c-.369 0-.595.09-.74.187a1.01 1.01 0 0 0-.34.398ZM9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"/></svg>');--md-admonition-icon--warning:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M6.457 1.047c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0 1 14.082 15H1.918a1.75 1.75 0 0 1-1.543-2.575Zm1.763.707a.25.25 0 0 0-.44 0L1.698 13.132a.25.25 0 0 0 .22.368h12.164a.25.25 0 0 0 .22-.368Zm.53 3.996v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0ZM9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"/></svg>');--md-admonition-icon--failure:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M2.344 2.343h-.001a8 8 0 0 1 11.314 11.314A8.002 8.002 0 0 1 .234 10.089a8 8 0 0 1 2.11-7.746Zm1.06 10.253a6.5 6.5 0 1 0 9.108-9.275 6.5 6.5 0 0 0-9.108 9.275ZM6.03 4.97 8 6.94l1.97-1.97a.749.749 0 0 1 1.275.326.749.749 0 0 1-.215.734L9.06 8l1.97 1.97a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215L8 9.06l-1.97 1.97a.749.749 0 0 1-1.275-.326.749.749 0 0 1 .215-.734L6.94 8 4.97 6.03a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018Z"/></svg>');--md-admonition-icon--danger:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M9.504.43a1.516 1.516 0 0 1 2.437 1.713L10.415 5.5h2.123c1.57 0 2.346 1.909 1.22 3.004l-7.34 7.142a1.249 1.249 0 0 1-.871.354h-.302a1.25 1.25 0 0 1-1.157-1.723L5.633 10.5H3.462c-1.57 0-2.346-1.909-1.22-3.004L9.503.429Zm1.047 1.074L3.286 8.571A.25.25 0 0 0 3.462 9H6.75a.75.75 0 0 1 .694 1.034l-1.713 4.188 6.982-6.793A.25.25 0 0 0 12.538 7H9.25a.75.75 0 0 1-.683-1.06l2.008-4.418.003-.006a.036.036 0 0 0-.004-.009l-.006-.006-.008-.001c-.003 0-.006.002-.009.004Z"/></svg>');--md-admonition-icon--bug:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M4.72.22a.75.75 0 0 1 1.06 0l1 .999a3.488 3.488 0 0 1 2.441 0l.999-1a.748.748 0 0 1 1.265.332.75.75 0 0 1-.205.729l-.775.776c.616.63.995 1.493.995 2.444v.327c0 .1-.009.197-.025.292.408.14.764.392 1.029.722l1.968-.787a.75.75 0 0 1 .556 1.392L13 7.258V9h2.25a.75.75 0 0 1 0 1.5H13v.5c0 .409-.049.806-.141 1.186l2.17.868a.75.75 0 0 1-.557 1.392l-2.184-.873A4.997 4.997 0 0 1 8 16a4.997 4.997 0 0 1-4.288-2.427l-2.183.873a.75.75 0 0 1-.558-1.392l2.17-.868A5.036 5.036 0 0 1 3 11v-.5H.75a.75.75 0 0 1 0-1.5H3V7.258L.971 6.446a.75.75 0 0 1 .558-1.392l1.967.787c.265-.33.62-.583 1.03-.722a1.677 1.677 0 0 1-.026-.292V4.5c0-.951.38-1.814.995-2.444L4.72 1.28a.75.75 0 0 1 0-1.06Zm.53 6.28a.75.75 0 0 0-.75.75V11a3.5 3.5 0 1 0 7 0V7.25a.75.75 0 0 0-.75-.75ZM6.173 5h3.654A.172.172 0 0 0 10 4.827V4.5a2 2 0 1 0-4 0v.327c0 .096.077.173.173.173Z"/></svg>');--md-admonition-icon--example:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M5 5.782V2.5h-.25a.75.75 0 0 1 0-1.5h6.5a.75.75 0 0 1 0 1.5H11v3.282l3.666 5.76C15.619 13.04 14.543 15 12.767 15H3.233c-1.776 0-2.852-1.96-1.899-3.458Zm-2.4 6.565a.75.75 0 0 0 .633 1.153h9.534a.75.75 0 0 0 .633-1.153L12.225 10.5h-8.45ZM9.5 2.5h-3V6c0 .143-.04.283-.117.403L4.73 9h6.54L9.617 6.403A.746.746 0 0 1 9.5 6Z"/></svg>');--md-admonition-icon--quote:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M1.75 2.5h10.5a.75.75 0 0 1 0 1.5H1.75a.75.75 0 0 1 0-1.5Zm4 5h8.5a.75.75 0 0 1 0 1.5h-8.5a.75.75 0 0 1 0-1.5Zm0 5h8.5a.75.75 0 0 1 0 1.5h-8.5a.75.75 0 0 1 0-1.5ZM2.5 7.75v6a.75.75 0 0 1-1.5 0v-6a.75.75 0 0 1 1.5 0Z"/></svg>');}</style>



    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/katex.min.css">
    
      <link rel="stylesheet" href="../../../css/latex.css">
    
      <link rel="stylesheet" href="../../../css/thm.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="deep-purple" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#9" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="AUG&#39;s Lecture Notes" class="md-header__button md-logo" aria-label="AUG's Lecture Notes" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            AUG's Lecture Notes
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              9 整除性
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
    
  
  主页

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../univ-intro/" class="md-tabs__link">
          
  
  高中大学衔接

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../volunteer/" class="md-tabs__link">
          
  
  公益实践活动

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../introi/" class="md-tabs__link">
          
  
  信息竞赛从入门到放弃

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../" class="md-tabs__link">
          
  
  附录

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="AUG&#39;s Lecture Notes" class="md-nav__button md-logo" aria-label="AUG's Lecture Notes" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    AUG's Lecture Notes
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    主页
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    高中大学衔接
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            高中大学衔接
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../univ-intro/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    高中与大学衔接: 计算机系简介
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../univ-intro/1-intro-all/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1. 认识计算机
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../univ-intro/hw1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    练习题1: 使用搜索引擎
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../univ-intro/lab1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    实验 1: 在 U 盘上安装 Linux
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    公益实践活动
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            公益实践活动
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../volunteer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    “七彩假期”社区科技教育志愿者服务
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../volunteer/1-comp-intro/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1. 认识计算机
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../volunteer/binary/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2. 认识二进制
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../volunteer/lec3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3. 程序的逻辑
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    信息竞赛从入门到放弃
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            信息竞赛从入门到放弃
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../introi/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OI:从入门到放弃 (2024夏季学期)
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  <span class="md-ellipsis">
    附录
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            附录
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    附录
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2" checked>
        
          
          <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    计算机科学中的数学
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            计算机科学中的数学
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    介绍:《计算机科学中的数学》
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2_2" checked>
        
          
          <label class="md-nav__link" for="__nav_5_2_2" id="__nav_5_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    正文
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_2_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5_2_2">
            <span class="md-nav__icon md-icon"></span>
            正文
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../2-wop/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2 良序原理
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../3-lf/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3 逻辑公式
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../4-mdt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4 数学中的”数据类型”
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../5-ind/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5 数学归纳法
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../6-smac/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6 状态机
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../7-rdt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7 递归的数据类型
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../8-infset/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    8 无穷集合
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    9 整除性
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    9 整除性
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#91" class="md-nav__link">
    <span class="md-ellipsis">
      9.1 可整除性
    </span>
  </a>
  
    <nav class="md-nav" aria-label="9.1 可整除性">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#911" class="md-nav__link">
    <span class="md-ellipsis">
      定义 9.1.1
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#911_1" class="md-nav__link">
    <span class="md-ellipsis">
      9.1.1 关于整除的事实
    </span>
  </a>
  
    <nav class="md-nav" aria-label="9.1.1 关于整除的事实">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#912" class="md-nav__link">
    <span class="md-ellipsis">
      引理 9.1.2
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#913" class="md-nav__link">
    <span class="md-ellipsis">
      定义 9.1.3
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#912_1" class="md-nav__link">
    <span class="md-ellipsis">
      9.1.2 当整除失效时
    </span>
  </a>
  
    <nav class="md-nav" aria-label="9.1.2 当整除失效时">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#914" class="md-nav__link">
    <span class="md-ellipsis">
      定理 9.1.4 （除法定理）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#915" class="md-nav__link">
    <span class="md-ellipsis">
      定义 9.1.5
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#913_1" class="md-nav__link">
    <span class="md-ellipsis">
      9.1.3 《虎胆龙威》
    </span>
  </a>
  
    <nav class="md-nav" aria-label="9.1.3 《虎胆龙威》">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      水壶不变量
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#916" class="md-nav__link">
    <span class="md-ellipsis">
      引理 9.1.6（水壶问题）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      引理
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#92" class="md-nav__link">
    <span class="md-ellipsis">
      9.2 最大公约数
    </span>
  </a>
  
    <nav class="md-nav" aria-label="9.2 最大公约数">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#921" class="md-nav__link">
    <span class="md-ellipsis">
      9.2.1 欧几里得算法
    </span>
  </a>
  
    <nav class="md-nav" aria-label="9.2.1 欧几里得算法">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#921_1" class="md-nav__link">
    <span class="md-ellipsis">
      引理 9.2.1
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      欧几里得算法作为状态机
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#922" class="md-nav__link">
    <span class="md-ellipsis">
      9.2.2 碎石机
    </span>
  </a>
  
    <nav class="md-nav" aria-label="9.2.2 碎石机">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#922_1" class="md-nav__link">
    <span class="md-ellipsis">
      定理 9.2.2
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#923" class="md-nav__link">
    <span class="md-ellipsis">
      推论 9.2.3
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#924" class="md-nav__link">
    <span class="md-ellipsis">
      推论 9.2.4
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#923_1" class="md-nav__link">
    <span class="md-ellipsis">
      9.2.3 解决所有水壶问题的一种方法
    </span>
  </a>
  
    <nav class="md-nav" aria-label="9.2.3 解决所有水壶问题的一种方法">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#925" class="md-nav__link">
    <span class="md-ellipsis">
      定理 9.2.5
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#924_1" class="md-nav__link">
    <span class="md-ellipsis">
      9.2.4 最大公约数的性质
    </span>
  </a>
  
    <nav class="md-nav" aria-label="9.2.4 最大公约数的性质">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#926" class="md-nav__link">
    <span class="md-ellipsis">
      引理 9.2.6
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#93" class="md-nav__link">
    <span class="md-ellipsis">
      9.3 素数之谜
    </span>
  </a>
  
    <nav class="md-nav" aria-label="9.3 素数之谜">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#931" class="md-nav__link">
    <span class="md-ellipsis">
      定义 9.3.1
    </span>
  </a>
  
    <nav class="md-nav" aria-label="定义 9.3.1">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      双素数猜想
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      因数分解的推测低效性
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      哥德巴赫猜想
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#932" class="md-nav__link">
    <span class="md-ellipsis">
      定义 9.3.2
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#933" class="md-nav__link">
    <span class="md-ellipsis">
      定理 9.3.3 （素数定理）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#934" class="md-nav__link">
    <span class="md-ellipsis">
      定理 9.3.4 （切比雪夫的素数密度定理）
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#94" class="md-nav__link">
    <span class="md-ellipsis">
      9.4 算术基本定理
    </span>
  </a>
  
    <nav class="md-nav" aria-label="9.4 算术基本定理">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#941" class="md-nav__link">
    <span class="md-ellipsis">
      定理 9.4.1（算术基本定理）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#941_1" class="md-nav__link">
    <span class="md-ellipsis">
      9.4.1 证明唯一分解性
    </span>
  </a>
  
    <nav class="md-nav" aria-label="9.4.1 证明唯一分解性">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#942" class="md-nav__link">
    <span class="md-ellipsis">
      引理 9.4.2
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#943" class="md-nav__link">
    <span class="md-ellipsis">
      引理 9.4.3
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#95-alan-turing" class="md-nav__link">
    <span class="md-ellipsis">
      9.5 Alan Turing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="9.5 Alan Turing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#951-10" class="md-nav__link">
    <span class="md-ellipsis">
      9.5.1 图灵密码（版本1.0）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#952-10" class="md-nav__link">
    <span class="md-ellipsis">
      9.5.2 破解图灵的密码（版本1.0）
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#96" class="md-nav__link">
    <span class="md-ellipsis">
      9.6 模运算
    </span>
  </a>
  
    <nav class="md-nav" aria-label="9.6 模运算">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#961" class="md-nav__link">
    <span class="md-ellipsis">
      引理 9.6.1 （余数）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#962" class="md-nav__link">
    <span class="md-ellipsis">
      引理 9.6.2
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#963" class="md-nav__link">
    <span class="md-ellipsis">
      推论 9.6.3
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#964" class="md-nav__link">
    <span class="md-ellipsis">
      引理 9.6.4 （同余）
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#97" class="md-nav__link">
    <span class="md-ellipsis">
      9.7 余数算术
    </span>
  </a>
  
    <nav class="md-nav" aria-label="9.7 余数算术">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      余数算术的一般原则
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#971-mathbb-z_n" class="md-nav__link">
    <span class="md-ellipsis">
      9.7.1 整数环\(\mathbb Z_n\)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="9.7.1 整数环\(\mathbb Z_n\)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#971" class="md-nav__link">
    <span class="md-ellipsis">
      引理 9.7.1
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#98-20" class="md-nav__link">
    <span class="md-ellipsis">
      9.8 图灵的密码（版本2.0）
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#99" class="md-nav__link">
    <span class="md-ellipsis">
      9.9 乘法逆元和消去
    </span>
  </a>
  
    <nav class="md-nav" aria-label="9.9 乘法逆元和消去">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#991" class="md-nav__link">
    <span class="md-ellipsis">
      9.9.1 互素
    </span>
  </a>
  
    <nav class="md-nav" aria-label="9.9.1 互素">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#991_1" class="md-nav__link">
    <span class="md-ellipsis">
      引理 9.9.1
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#992" class="md-nav__link">
    <span class="md-ellipsis">
      引理 9.9.2
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#992_1" class="md-nav__link">
    <span class="md-ellipsis">
      9.9.2 消去
    </span>
  </a>
  
    <nav class="md-nav" aria-label="9.9.2 消去">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#993" class="md-nav__link">
    <span class="md-ellipsis">
      定义 9.9.3
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#994" class="md-nav__link">
    <span class="md-ellipsis">
      引理 9.9.4
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#995" class="md-nav__link">
    <span class="md-ellipsis">
      定理 9.9.5
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#993-20" class="md-nav__link">
    <span class="md-ellipsis">
      9.9.3 解密（版本2.0）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#994-20" class="md-nav__link">
    <span class="md-ellipsis">
      9.9.4 破解图灵密码（版本2.0）
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#995_1" class="md-nav__link">
    <span class="md-ellipsis">
      9.9.5 图灵后记
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#910" class="md-nav__link">
    <span class="md-ellipsis">
      9.10 欧拉定理
    </span>
  </a>
  
    <nav class="md-nav" aria-label="9.10 欧拉定理">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#9101" class="md-nav__link">
    <span class="md-ellipsis">
      定义 9.10.1
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      定理（欧拉定理）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9102" class="md-nav__link">
    <span class="md-ellipsis">
      定义 9.10.2
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9103-z_n" class="md-nav__link">
    <span class="md-ellipsis">
      定理 9.10.3 （\(Z_n\) 中的欧拉定理）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9104" class="md-nav__link">
    <span class="md-ellipsis">
      引理 9.10.4
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9105" class="md-nav__link">
    <span class="md-ellipsis">
      定义 9.10.5
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9106" class="md-nav__link">
    <span class="md-ellipsis">
      引理 9.10.6
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9107" class="md-nav__link">
    <span class="md-ellipsis">
      推论 9.10.7
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9108" class="md-nav__link">
    <span class="md-ellipsis">
      推论 9.10.8 （费马小定理）
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#9101-phi" class="md-nav__link">
    <span class="md-ellipsis">
      9.10.1 计算欧拉 \(\phi\) 函数
    </span>
  </a>
  
    <nav class="md-nav" aria-label="9.10.1 计算欧拉 \(\phi\) 函数">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#9109" class="md-nav__link">
    <span class="md-ellipsis">
      引理 9.10.9
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#91010" class="md-nav__link">
    <span class="md-ellipsis">
      定理 9.10.10
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#91011" class="md-nav__link">
    <span class="md-ellipsis">
      推论 9.10.11
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#911-rsa" class="md-nav__link">
    <span class="md-ellipsis">
      9.11 RSA 公钥加密
    </span>
  </a>
  
    <nav class="md-nav" aria-label="9.11 RSA 公钥加密">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rsa" class="md-nav__link">
    <span class="md-ellipsis">
      RSA 加密系统
    </span>
  </a>
  
    <nav class="md-nav" aria-label="RSA 加密系统">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    <span class="md-ellipsis">
      预先准备
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    <span class="md-ellipsis">
      编码
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    <span class="md-ellipsis">
      解码
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#912-sat" class="md-nav__link">
    <span class="md-ellipsis">
      9.12 SAT 与此有何关系？
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../10-gra-part/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    10. 有向图和偏序关系
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../11-cnet/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    11.通信网络
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../12-simpl-gra/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    12. 简单图
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_3" >
        
          
          <label class="md-nav__link" for="__nav_5_3" id="__nav_5_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    算法
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_3">
            <span class="md-nav__icon md-icon"></span>
            算法
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    介绍:《算法》by Jeff. E.
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_4" >
        
          
          <label class="md-nav__link" for="__nav_5_4" id="__nav_5_4_label" tabindex="">
            
  
  <span class="md-ellipsis">
    (初)高中数学甲种课本
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_4">
            <span class="md-nav__icon md-icon"></span>
            (初)高中数学甲种课本
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../hsmath/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    介绍:中学数学实验教材
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="9">9 整除性</h1>
<p>数论是研究整数的学问. 为什么有人会想研究整数可能并不明显. 首先,
有什么好研究的？有 <span class="arithmatex">\(0\)</span>, 有 <span class="arithmatex">\(1, 2, 3\)</span>, 等等, 还有, 哦对了,
<span class="arithmatex">\(-1, -2, \ldots\)</span>. 哪一个你不理解呢？它有什么实际价值呢？</p>
<p>数学家 G. H. Hardy 对其非实用性感到高兴. 他写道:</p>
<blockquote>
<p>[数论学者] 也许有理由为此感到高兴, 因为至少有一门科学,
其本身与普通人类活动的距离应该使其保持温和和纯洁.</p>
</blockquote>
<p>Hardy 尤其担心数论被用于战争；他是一个和平主义者. 你可能会赞同他的观点,
但他错了: 数论是现代密码学的基础, 而密码学使得安全的在线通信成为可能.
当然, 在战争中安全通信至关重要——可怜的 Hardy 在坟墓里会感到无比痛苦.
数论同样也是在线商务的核心. 每当你从 Amazon 购买书籍, 使用证书访问网页,
或使用 PayPal 账户时, 你都在依赖数论算法.</p>
<p>数论还为我们提供了一个绝佳的环境来练习和应用我们在前几章中开发的证明技巧.
我们将研究最大公约数（gcd）的性质, 并用它们来证明整数唯一地分解为质数.
然后我们将介绍模运算, 并研究其足够多的性质来解释 RSA 公钥密码系统.</p>
<p>既然我们将专注于整数的性质, 我们将在本章中采用默认约定, 即变量在整数集
<span class="arithmatex">\(\mathbb{Z}\)</span> 上取值.</p>
<h2 id="91">9.1 可整除性</h2>
<p>数论的本质一旦我们考虑到除法关系就会显现出来.</p>
<div class="def">
<h4 id="911">定义 9.1.1</h4>
<div class="arithmatex">\[
a \mid b
\]</div>
<p>当且仅当存在整数 <span class="arithmatex">\(k\)</span> 使得</p>
<div class="arithmatex">\[
ak = b
\]</div>
</div>
<p>上述符号关系频繁出现, 因此有许多同义词:</p>
<ul>
<li><span class="arithmatex">\(a \mid b\)</span>,</li>
<li><span class="arithmatex">\(a\)</span> 整除 <span class="arithmatex">\(b\)</span>,</li>
<li><span class="arithmatex">\(a\)</span> 是 <span class="arithmatex">\(b\)</span> 的因数,</li>
<li><span class="arithmatex">\(b\)</span> 可以被 <span class="arithmatex">\(a\)</span> 整除,</li>
<li><span class="arithmatex">\(b\)</span> 是 <span class="arithmatex">\(a\)</span> 的倍数.</li>
</ul>
<p>从定义 9.1.1 中立刻推导出的结论是对于所有的 <span class="arithmatex">\(n\)</span></p>
<div class="arithmatex">\[
n \mid 0, \quad n \mid n, \quad \text{and} \quad \pm 1 \mid n
\]</div>
<p>此外,</p>
<div class="arithmatex">\[
0 \mid n \implies n = 0.
\]</div>
<p>除法看起来很简单, 但让我们利用这个定义来进行一些演算. 毕达哥拉斯学派,
一个古老的数学神秘教派, 认为一个数是完美的, 如果它等于其正整数因子之和,
不包括其自身. 例如, <span class="arithmatex">\(6 = 1 + 2 + 3\)</span> 和 <span class="arithmatex">\(28 = 1 + 2 + 4 + 7 + 14\)</span>
是完美数. 另一方面, <span class="arithmatex">\(10\)</span> 不是完美数, 因为 <span class="arithmatex">\(1 + 2 + 5 = 8\)</span>, 而 <span class="arithmatex">\(12\)</span>
也不是完美数, 因为 <span class="arithmatex">\(1 + 2 + 3 + 4 + 6 = 16\)</span>. 欧几里得在大约公元前 300
年（问题 9.2）描述了所有的偶完美数. 但是否存在奇完美数？两千多年过去了,
我们仍然不知道！大约 <span class="arithmatex">\(10^{300}\)</span> 以内的所有数都已被排除,
但没有人证明不存在一个奇完美数等待被发现.</p>
<p>所以, 虽然我们才讨论了半页内容, 但已经超越了人类知识的边界.
这是很典型的情况；数论充满了容易提出但难以回答的问题.
我们将在后面的章节中提到更多此类问题.</p>
<h3 id="911_1">9.1.1 关于整除的事实</h3>
<p>下面的引理收集了一些关于整除的基本事实.</p>
<div class="lem">
<h4 id="912">引理 9.1.2</h4>
<ol>
<li>如果 <span class="arithmatex">\(a \mid b\)</span> 且 <span class="arithmatex">\(b \mid c\)</span>, 则 <span class="arithmatex">\(a \mid c\)</span>.</li>
<li>如果 <span class="arithmatex">\(a \mid b\)</span> 且 <span class="arithmatex">\(a \mid c\)</span>, 则 <span class="arithmatex">\(a \mid sb + tc\)</span> 对于所有 <span class="arithmatex">\(s\)</span> 和
    <span class="arithmatex">\(t\)</span> 成立.</li>
<li>对于所有 <span class="arithmatex">\(c \neq 0\)</span>, <span class="arithmatex">\(a \mid b\)</span> 当且仅当 <span class="arithmatex">\(ca \mid cb\)</span>.</li>
</ol>
</div>
<div class="prf">
<p>这些事实都直接从定义 9.1.1 推导出来. 为了说明这一点, 我们将仅证明第2点:</p>
<p>假设 <span class="arithmatex">\(a \mid b\)</span>, 则存在某个 <span class="arithmatex">\(k_1 \in \mathbb{Z}\)</span> 使得 <span class="arithmatex">\(ak_1 = b\)</span>.
同样地, <span class="arithmatex">\(ak_2 = c\)</span>, 因此</p>
<div class="arithmatex">\[
sb + tc = s(k_1a) + t(k_2a) = (sk_1 + tk_2)a.
\]</div>
<p>因此 <span class="arithmatex">\(sb + tc = k_3a\)</span> 其中 <span class="arithmatex">\(k_3 ::= (sk_1 + tk_2)\)</span>, 这意味着</p>
<div class="arithmatex">\[
a \mid sb + tc.
\]</div>
</div>
<p>一个形如 <span class="arithmatex">\(sb + tc\)</span> 的数称为 <span class="arithmatex">\(b\)</span> 和 <span class="arithmatex">\(c\)</span> 的整数线性组合, 或者,
既然在本章中我们只讨论整数, 称为线性组合. 因此引理 9.1.2.2 可以改写为</p>
<p>如果 <span class="arithmatex">\(a\)</span> 可整除 <span class="arithmatex">\(b\)</span> 和 <span class="arithmatex">\(c\)</span>, 那么 <span class="arithmatex">\(a\)</span> 可整除 <span class="arithmatex">\(b\)</span> 和 <span class="arithmatex">\(c\)</span> 的每一个线性组合.</p>
<p>我们将充分利用线性组合, 所以让我们记录下线性组合的通用定义:</p>
<div class="def">
<h4 id="913">定义 9.1.3</h4>
<p>一个整数 <span class="arithmatex">\(n\)</span> 是数 <span class="arithmatex">\(b_0, \ldots, b_k\)</span> 的线性组合当且仅当</p>
<div class="arithmatex">\[
n = s_0b_0 + s_1b_1 + \cdots + s_kb_k
\]</div>
<p>对于一些整数 <span class="arithmatex">\(s_0, \ldots, s_k\)</span>.</p>
</div>
<h3 id="912_1">9.1.2 当整除失效时</h3>
<p>正如你在小学所学的, 如果一个数不能整除另一个数,
你会得到一个“商”和一个“余数”. 更准确地说:</p>
<div class="thm">
<h4 id="914">定理 9.1.4 （除法定理）</h4>
<p>设 <span class="arithmatex">\(n\)</span> 和 <span class="arithmatex">\(d\)</span> 为整数且 <span class="arithmatex">\(d \neq 0\)</span>. 则存在一对唯一的整数 <span class="arithmatex">\(q\)</span> 和 <span class="arithmatex">\(r\)</span>, 使得</p>
<div class="arithmatex">\[
n = q \cdot d + r \quad \text{且} \quad 0 \leq r &lt; |d|.
\]</div>
</div>
<p>数 <span class="arithmatex">\(q\)</span> 称为商, 数 <span class="arithmatex">\(r\)</span> 称为 <span class="arithmatex">\(n\)</span> 除以 <span class="arithmatex">\(d\)</span> 的余数. 我们用记号
<span class="arithmatex">\(\text{qc}nt(n, d)\)</span> 表示商, 用 <span class="arithmatex">\(\text{rem}(n, d)\)</span> 表示余数.</p>
<p>上面的绝对值记号 <span class="arithmatex">\(|d|\)</span> 你可能在初等微积分中已经熟悉, 但为了记录在案,
我们定义它.</p>
<div class="def">
<h4 id="915">定义 9.1.5</h4>
<p>对于任何实数 <span class="arithmatex">\(r\)</span>, 绝对值 <span class="arithmatex">\(|r|\)</span> 或 <span class="arithmatex">\(r\)</span> 定义为:</p>
<div class="arithmatex">\[
|r| ::= 
\begin{cases} 
r &amp; \text{if } r \geq 0,\\
-r &amp; \text{if } r &lt; 0.
\end{cases}
\]</div>
</div>
<p>因此, 根据定义, 余数 <span class="arithmatex">\(\text{rem}(n, d)\)</span> 是非负的, 无论 <span class="arithmatex">\(n\)</span> 和 <span class="arithmatex">\(d\)</span>
的符号如何. 例如, <span class="arithmatex">\(\text{rem}(-11, 7) = 3\)</span>, 因为
<span class="arithmatex">\(-11 = (-2) \cdot 7 + 3\)</span>.</p>
<p>编程语言中的“余数”操作可能会引起混淆. 例如, 在 Java, C 和 C++ 中, 表达式
<span class="arithmatex">\("32 \% 5"\)</span> 会求值为 <span class="arithmatex">\(\text{rem}(32, 5) = 2\)</span>. 但在其他语言中,
<span class="arithmatex">\("32 \% -5"\)</span> 或 <span class="arithmatex">\("-32 \% 5"\)</span> 可能会涉及负数的余数.
不要被你熟悉的编程语言中的余数行为所误导, 坚持数学上的余数非负的约定.</p>
<p>除以 <span class="arithmatex">\(d\)</span> 的余数在定义上是从 0 到 <span class="arithmatex">\(|d| - 1\)</span> 的数. 这种整数区间经常出现,
因此我们为它们定义一个简单的记号. 对于 <span class="arithmatex">\(k \leq n \in \mathbb{Z}\)</span>,</p>
<div class="arithmatex">\[
(k..n) ::= \{i \mid k &lt; i &lt; n\},
\]</div>
<div class="arithmatex">\[
(k..n] ::= (k, n) \cup \{n\},
\]</div>
<div class="arithmatex">\[
[k..n) ::= {k} \cup (k, n)
\]</div>
<div class="arithmatex">\[
[k..n] ::= \{k\} \cup (k, n) \cup \{n\} = \{i \mid k \leq i \leq n\}.
\]</div>
<h3 id="913_1">9.1.3 《<strong>虎胆龙威</strong>》</h3>
<p>《<strong>虎胆龙威</strong>3》只是个B级动作电影, 但我们认为它有一个内在的信息:
每个人都应该至少学一点数论. 在第6.2.3节中,
我们形式化了一个名为虎胆龙威水壶问题的状态机, 其包含3加仑和5加仑的壶.</p>
<p>在电影中, 虎胆龙威试图用3加仑和9加仑的壶解决倒水问题,
并且看它能不能凑出来某个特定的值. 那么, 一般情况下会发生什么呢？例如,
能不能从12加仑和18加仑的壶中得到4加仑,
能不能用899加仑和1147加仑的壶得到32加仑,
或用21加仑和26加仑的壶得到3加仑？</p>
<p>如果我们能够一次性解决所有这些愚蠢的水壶问题, 那就太好了.
这就是数论的用武之地.</p>
<h4 id="_1">水壶不变量</h4>
<p>假设我们有容量分别为 <span class="arithmatex">\(a\)</span> 和 <span class="arithmatex">\(b\)</span> 的水壶, 且 <span class="arithmatex">\(b \geq a\)</span>.
让我们进行一些状态机操作的示例, 看看会发生什么, 假设 <span class="arithmatex">\(b\)</span> 水壶足够大:</p>
<div class="arithmatex">\[
\begin{align*}
(0, 0) &amp;\rightarrow (a, 0) \quad \text{填满第一个水壶} \\
&amp;\rightarrow (0, a) \quad \text{倒入第二个水壶} \\
&amp;\rightarrow (a, a) \quad \text{填满第一个水壶} \\
&amp;\rightarrow (2a - b, b) \quad \text{倒入第二个水壶（假设 2a \geq b）} \\
&amp;\rightarrow (2a - b, 0) \quad \text{倒空第二个水壶} \\
&amp;\rightarrow (0, 2a - b) \quad \text{倒入第二个水壶} \\
&amp;\rightarrow (a, 2a - b) \quad \text{填满第一个水壶} \\
&amp;\rightarrow (3a - 2b, b) \quad \text{倒入第二个水壶（假设 3a \geq 2b）}
\end{align*}
\]</div>
<p>显而易见, 每一步中, 每个水壶中的水量都是 <span class="arithmatex">\(a\)</span> 和 <span class="arithmatex">\(b\)</span> 的线性组合.
通过对转换次数进行归纳, 这很容易证明:</p>
<div class="lem">
<h4 id="916">引理 9.1.6（水壶问题）</h4>
<p>在第6.2.3节的虎胆龙威状态机中, 容量为 <span class="arithmatex">\(a\)</span> 和 <span class="arithmatex">\(b\)</span> 的水壶,
每个水壶中的水量始终是 <span class="arithmatex">\(a\)</span> 和 <span class="arithmatex">\(b\)</span> 的线性组合.</p>
</div>
<div class="prf">
<p>归纳假设 <span class="arithmatex">\(P(n)\)</span> 是在 <span class="arithmatex">\(n\)</span> 次转换后, 每个水壶中的水量是 <span class="arithmatex">\(a\)</span> 和 <span class="arithmatex">\(b\)</span>
的线性组合.</p>
<p>基例（<span class="arithmatex">\(n = 0\)</span>）: <span class="arithmatex">\(P(0)\)</span> 是正确的, 因为两个水壶最初都是空的, 且
<span class="arithmatex">\(0 \cdot a + 0 \cdot b = 0\)</span>.</p>
<p>归纳步: 假设状态机在 <span class="arithmatex">\(n\)</span> 步后处于状态 <span class="arithmatex">\((x, y)\)</span>, 即小水壶含有 <span class="arithmatex">\(x\)</span> 加仑,
大水壶含有 <span class="arithmatex">\(y\)</span> 加仑. 有两种情况:</p>
<ul>
<li>如果我们从喷泉中填满一个水壶或将一个水壶倒入喷泉中,
    那么该水壶为空或已满. 另一水壶中的水量仍然是 <span class="arithmatex">\(a\)</span> 和 <span class="arithmatex">\(b\)</span> 的线性组合.
    因此 <span class="arithmatex">\(P(n + 1)\)</span> 成立.</li>
<li>否则, 我们将水从一个水壶倒入另一个水壶,
    直到一个水壶空了或另一个水壶满了. 根据我们的假设, 在开始倒水之前,
    每个水壶中的水量 <span class="arithmatex">\(x\)</span> 和 <span class="arithmatex">\(y\)</span> 是 <span class="arithmatex">\(a\)</span> 和 <span class="arithmatex">\(b\)</span> 的线性组合. 倒水之后,
    一个水壶要么空了（含有 0 加仑）, 要么满了（含有 <span class="arithmatex">\(a\)</span> 或 <span class="arithmatex">\(b\)</span> 加仑）.
    因此, 另一个水壶含有 <span class="arithmatex">\(x + y\)</span>, <span class="arithmatex">\(x + y - a\)</span> 或 <span class="arithmatex">\(x + y - b\)</span> 加仑,
    这些都是 <span class="arithmatex">\(a\)</span> 和 <span class="arithmatex">\(b\)</span> 的线性组合, 因为 <span class="arithmatex">\(x\)</span> 和 <span class="arithmatex">\(y\)</span> 是线性组合. 所以
    <span class="arithmatex">\(P(n + 1)\)</span> 在这种情况下也成立.</li>
</ul>
<p>由于 <span class="arithmatex">\(P(n+1)\)</span> 也满足分类讨论的情况, 我们可以使用归纳法成功证明.</p>
</div>
<div class="lem">
<h4 id="_2">引理</h4>
<p>尝试用 12 加仑和 18 加仑的水壶得到 4 加仑, 以及用 899 加仑和 1147
加仑的水壶得到 32 加仑时, 布鲁斯将会失败！</p>
</div>
<div class="prf">
<p>根据水壶引理 9.1.6, 使用 12 加仑和 18 加仑的水壶时, 任何水壶中的水量都是
12 和 18 的线性组合. 根据引理 9.1.2.2, 这总是 6 的倍数,
所以布鲁斯无法得到 4 加仑. 同样地, 使用 899 加仑和 1147 加仑的水壶时,
任何水壶中的水量都是 31 的倍数, 所以他也无法得到 32 加仑.</p>
</div>
<p>但水壶引理并不能告诉我们完整的故事. 例如, 它没有回答用 21 加仑和 26
加仑的水壶得到 3 加仑的问题: 21 和 26 的唯一正因子是 1, 当然 1 能整除 3,
所以该引理既不排除也不确认能得到 3 加仑的可能性.</p>
<p>更大的问题是,
我们刚刚设法将一个相当容易理解的关于水壶的问题重新描述成一个关于线性组合的问题.
这似乎进展不大. 幸运的是, 线性组合与更为熟悉的最大公约数密切相关,
这将帮助我们解决一般的水壶问题.</p>
<h2 id="92">9.2 最大公约数</h2>
<p><span class="arithmatex">\(a\)</span> 和 <span class="arithmatex">\(b\)</span> 的公约数是同时整除它们的数. <span class="arithmatex">\(a\)</span> 和 <span class="arithmatex">\(b\)</span> 的最大公约数记作
<span class="arithmatex">\(\text{gcd}(a, b)\)</span>. 例如, <span class="arithmatex">\(\text{gcd}(18, 24) = 6\)</span>. 只要 <span class="arithmatex">\(a\)</span> 和 <span class="arithmatex">\(b\)</span>
不同时为 0, 它们就有一个最大公约数. 最大公约数在推理 <span class="arithmatex">\(a\)</span> 和 <span class="arithmatex">\(b\)</span>
之间的关系以及一般整数之间的关系时非常有价值.
我们将在后续内容中大量使用最大公约数.</p>
<p>根据最大公约数的定义, 立刻可以得出以下结果:</p>
<div class="arithmatex">\[
\text{gcd}(n, 1) = 1
\]</div>
<div class="arithmatex">\[
\text{gcd}(n, n) = \text{gcd}(n, 0) = |n| \quad \text{对于} \quad n \neq 0
\]</div>
<p>其中最后一个等式来自于一切数都是 0 的约数这一事实.</p>
<h3 id="921">9.2.1 欧几里得算法</h3>
<p>首先需要弄清楚的是如何找到最大公约数.
一种被称为欧几里得算法的好方法已经存在了几千年. 它基于以下简单的观察.</p>
<div class="lem">
<h4 id="921_1">引理 9.2.1</h4>
<p>对于 <span class="arithmatex">\(b \neq 0\)</span>,</p>
<div class="arithmatex">\[
\text{gcd}(a, b) = \text{gcd}(b, \text{rem}(a, b))
\]</div>
</div>
<div class="prf">
<p>根据除法定理 9.1.4,</p>
<div class="arithmatex">\[
a = qb + r \quad \tag{9.2}
\]</div>
<p>其中 <span class="arithmatex">\(r = \text{rem}(a, b)\)</span>. 因此 <span class="arithmatex">\(a\)</span> 是 <span class="arithmatex">\(b\)</span> 和 <span class="arithmatex">\(r\)</span> 的线性组合,
这意味着根据引理 9.1.2.2, <span class="arithmatex">\(b\)</span> 和 <span class="arithmatex">\(r\)</span> 的任何约数都是 <span class="arithmatex">\(a\)</span> 的约数. 同样地,
<span class="arithmatex">\(r\)</span> 是 <span class="arithmatex">\(a\)</span> 和 <span class="arithmatex">\(b\)</span> 的线性组合, 因此 <span class="arithmatex">\(a\)</span> 和 <span class="arithmatex">\(b\)</span> 的任何约数都是 <span class="arithmatex">\(r\)</span> 的约数.
这意味着 <span class="arithmatex">\(a\)</span> 和 <span class="arithmatex">\(b\)</span> 与 <span class="arithmatex">\(b\)</span> 和 <span class="arithmatex">\(r\)</span> 有相同的公约数,
因此它们有相同的最大公约数.</p>
</div>
<p>引理 9.2.1 对于快速计算两个数的最大公约数非常有用. 例如,
我们可以通过反复应用它来计算 1147 和 899 的最大公约数:</p>
<div class="arithmatex">\[
\begin{aligned}
&amp;\text{gcd}(1147, 899) \\
&amp;= \text{gcd}(899, \text{rem}(1147, 899)) \\
&amp;= \text{gcd}(899, 248) \\
&amp;= \text{gcd}(248, \text{rem}(899, 248)) \\
&amp;= \text{gcd}(248, 155) \\
&amp;= \text{gcd}(155, \text{rem}(248, 155)) \\
&amp;= \text{gcd}(155, 93) \\
&amp;= \text{gcd}(93, \text{rem}(155, 93)) \\
&amp;= \text{gcd}(93, 62) \\
&amp;= \text{gcd}(62, \text{rem}(93, 62)) \\
&amp;= \text{gcd}(62, 31) \\
&amp;= \text{gcd}(31, \text{rem}(62, 31)) \\
&amp;= \text{gcd}(31, 0) \\
&amp;= 31
\end{aligned}
\]</div>
<p>计算得知 <span class="arithmatex">\(\gcd(1147, 899) = 31\)</span>, 因此我们确定用1147和899大小的水壶,
布鲁斯在试图得到32加仑水时会失败.</p>
<p>另一方面, 应用欧几里得算法到26和21, 得到
<span class="arithmatex">\(\gcd(26, 21) = \gcd(21, 5) = \gcd(5, 1) = 1\)</span>；
因此我们不能用上述推理来排除布鲁斯将3加仑水倒入大水壶的可能性. 事实上,
由于这里的gcd是1, 布鲁斯将能够将任意数量的水倒入大水壶, 直到其容量.
要解释这一点, 我们需要更多的数论知识.</p>
<h4 id="_3">欧几里得算法作为状态机</h4>
<p>欧几里得算法可以很容易地形式化为状态机. 状态集合是N²,
并且只有一个转移规则:</p>
<div class="arithmatex">\[
(x, y) \rightarrow (y, \text{rem}(x, y)); \quad \text{对于 } y &gt; 0.  \tag{9.3}
\]</div>
<p>根据引理9.2.1, 从一个状态到下一个状态, gcd保持不变. 这意味着谓词</p>
<div class="arithmatex">\[
\text{gcd}(x, y) = \text{gcd}(a, b)
\]</div>
<p>在状态<span class="arithmatex">\((x, y)\)</span>上是一个保持的不变量. 当然,
这在开始状态<span class="arithmatex">\((a, b)\)</span>中是真实的. 所以根据不变量原则, 如果<span class="arithmatex">\(y\)</span>变为0,
则不变量仍然成立, 因此</p>
<div class="arithmatex">\[
x = \text{gcd}(x, 0) = \text{gcd}(a, b). 
\]</div>
<p>即<span class="arithmatex">\(x\)</span>的值将是所需的gcd.</p>
<p>而且<span class="arithmatex">\(x\)</span>和<span class="arithmatex">\(y\)</span>很快会变为0. 要了解原因, 注意从<span class="arithmatex">\((x, y)\)</span>开始,
两次转移会导致第一个坐标为<span class="arithmatex">\(\text{rem}(x, y)\)</span>的状态, 这最多是<span class="arithmatex">\(x\)</span>的一半.
因为<span class="arithmatex">\(x\)</span>起始时等于<span class="arithmatex">\(a\)</span>, 并且每两步减半或更少, 因此在最多<span class="arithmatex">\(2\log a\)</span>次转移后,
它将达到最小值——即<span class="arithmatex">\(\text{gcd}(a, b)\)</span>. 之后,
算法最多再进行一次转移就会终止. 换句话说,
欧几里得算法最多在<span class="arithmatex">\(1 + 2\log a\)</span>次转移后终止.</p>
<h3 id="922">9.2.2 碎石机</h3>
<p>我们将从以下关键事实中受益良多:</p>
<div class="thm">
<h4 id="922_1">定理 9.2.2</h4>
<p><span class="arithmatex">\(a\)</span> 和 <span class="arithmatex">\(b\)</span> 的最大公约数是 <span class="arithmatex">\(a\)</span> 和 <span class="arithmatex">\(b\)</span> 的线性组合. 即:</p>
<div class="arithmatex">\[
\text{gcd}(a, b) = sa + tb,
\]</div>
<p>其中 <span class="arithmatex">\(s\)</span> 和 <span class="arithmatex">\(t\)</span> 是一些整数.</p>
</div>
<p>我们已经从引理 9.1.2.2 知道 <span class="arithmatex">\(a\)</span> 和 <span class="arithmatex">\(b\)</span> 的每个线性组合都可以被 <span class="arithmatex">\(a\)</span> 和 <span class="arithmatex">\(b\)</span>
的任何公因数整除, 所以它当然可以被这些公因数中最大的整除.
由于线性组合的任何常数倍也是线性组合, 定理 9.2.2 表明 gcd
的任何倍数都是线性组合, 从而得出:</p>
<div class="cor">
<h4 id="923">推论 9.2.3</h4>
<p>整数是 <span class="arithmatex">\(a\)</span> 和 <span class="arithmatex">\(b\)</span> 的线性组合当且仅当它是 <span class="arithmatex">\(\text{gcd}(a, b)\)</span> 的倍数.</p>
</div>
<p>我们将通过解释如何找到 <span class="arithmatex">\(s\)</span> 和 <span class="arithmatex">\(t\)</span> 来直接证明定理 9.2.2.
这项任务由一个数学工具完成, 该工具可以追溯到公元六世纪的印度,
当时它被称为 kuttaka, 意思是“碎石机”. 今天,
碎石机更常被称为“扩展欧几里得算法”, 因为它与欧几里得算法非常接近.</p>
<p>例如, 按照欧几里得算法, 我们可以如下计算259和70的gcd:</p>
<div class="arithmatex">\[
\text{gcd}(259, 70) = \text{gcd}(70, 49) = \text{gcd}(49, 21) = \text{gcd}(21, 7) = \text{gcd}(7, 0) = 7;
\]</div>
<p>其中, <span class="arithmatex">\(\text{rem}(259, 70) = 49\)</span>, <span class="arithmatex">\(\text{rem}(70, 49) = 21\)</span>,
<span class="arithmatex">\(\text{rem}(49, 21) = 7\)</span>, <span class="arithmatex">\(\text{rem}(21, 7) = 0\)</span>.</p>
<p>碎石机也经过相同的步骤, 但在此过程中需要一些额外的记录: 当我们计算
<span class="arithmatex">\(\text{gcd}(a, b)\)</span> 时,
我们要记录如何将每个余数（在此例中是49、21和7）写成<span class="arithmatex">\(a\)</span>和<span class="arithmatex">\(b\)</span>的线性组合.
这是值得的, 因为我们的目标是写出最后一个非零余数.</p>
<p>即将最后一个非零余数, 即 gcd, 写成 <span class="arithmatex">\(a\)</span> 和 <span class="arithmatex">\(b\)</span> 的线性组合.
对于我们的例子, 以下是额外的记录过程:</p>
<div class="arithmatex">\[
\begin{array}{ccrl}
x &amp; y &amp; (\operatorname{rem}(x, y)) &amp; =x-q \cdot y \\
\hline 259 &amp; 70 &amp; 49 &amp; =a-3 \cdot b \\
70 &amp; 49 &amp; 21 &amp; =b-1 \cdot 49 \\
&amp; &amp; &amp; =b-1 \cdot(a-3 \cdot b) \\
49 &amp; 21 &amp; 7 &amp; =-1 \cdot a+4 \cdot b \\
&amp; &amp; &amp; =(a-3 \cdot b)-2 \cdot(-1 \cdot a+4 \cdot b) \\
21 &amp; 7 &amp; &amp; =3 \cdot a-11 \cdot b
\end{array}
\]</div>
<p>我们开始时初始化了两个变量, <span class="arithmatex">\(x = a\)</span> 和 <span class="arithmatex">\(y = b\)</span>. 在上面的前两列中,
我们执行了欧几里得算法. 在每一步中, 我们计算 <span class="arithmatex">\(\text{rem}(x, y)\)</span>, 其等于
<span class="arithmatex">\(x - \left\lfloor \frac{x}{y} \right\rfloor \cdot y\)</span>. 然后, 在这个 <span class="arithmatex">\(x\)</span>
和 <span class="arithmatex">\(y\)</span> 的线性组合中, 我们用我们已经计算出的等价于 <span class="arithmatex">\(a\)</span> 和 <span class="arithmatex">\(b\)</span>
的线性组合来替换 <span class="arithmatex">\(x\)</span> 和 <span class="arithmatex">\(y\)</span>. 简化后, 我们得到了一个等于
<span class="arithmatex">\(\text{rem}(x, y)\)</span> 的 <span class="arithmatex">\(a\)</span> 和 <span class="arithmatex">\(b\)</span> 的线性组合. 最终的解决方案被框起来.</p>
<p>这应该很清楚地表明了碎石机是如何工作的以及为何有效. 如果你有疑问,
可以参考问题 9.13, 其中将碎石机形式化为状态机,
然后使用欧几里得算法中使用的不变量的扩展进行验证.</p>
<p>由于碎石机只需要比欧几里得算法多一点计算量,
你可以使用这个算法非常快速地“粉碎”非常大的数字. 正如我们很快将看到的,
它的速度使得碎石机在密码学领域成为一个非常有用的工具.</p>
<p>现在我们可以根据最大公约数重新表述水壶引理 9.1.6:</p>
<div class="cor">
<h4 id="924">推论 9.2.4</h4>
<p>假设我们有容量为 <span class="arithmatex">\(a\)</span> 和 <span class="arithmatex">\(b\)</span> 的水壶. 那么每个水壶中的水量总是
<span class="arithmatex">\(\text{gcd}(a, b)\)</span> 的倍数.</p>
</div>
<p>例如, 使用3加仑和6加仑的水壶无法得到4加仑, 因为4不是
<span class="arithmatex">\(\text{gcd}(3, 6) = 3\)</span> 的倍数.</p>
<h3 id="923_1">9.2.3 解决所有水壶问题的一种方法</h3>
<p>推论 9.2.3 表明, 3 可以写成 21 和 26 的线性组合, 因为 3 是
<span class="arithmatex">\(\text{gcd}(21, 26) = 1\)</span> 的倍数. 所以碎石机会给我们整数 <span class="arithmatex">\(s\)</span> 和 <span class="arithmatex">\(t\)</span>, 使得</p>
<div class="arithmatex">\[
3 = s \cdot 21 + t \cdot 26 \tag{9.5}
\]</div>
<p>系数 <span class="arithmatex">\(s\)</span> 可以是正数也可以是负数. 然而,
我们可以很容易地将这个线性组合转换为等价的线性组合</p>
<div class="arithmatex">\[
3 = s' \cdot 21 + t' \cdot 26 \tag{9.6}
\]</div>
<p>其中系数 <span class="arithmatex">\(s'\)</span> 为正. 诀窍是注意到, 如果在方程 (9.5) 中增加 <span class="arithmatex">\(s\)</span>
的值（每次增加 26）并减少 <span class="arithmatex">\(t\)</span> 的值（每次减少 21）, 则表达式
<span class="arithmatex">\(s \cdot 21 + t \cdot 26\)</span> 的值总体上保持不变. 因此, 通过反复增加 <span class="arithmatex">\(s\)</span>
的值（每次增加 26）并减少 <span class="arithmatex">\(t\)</span> 的值（每次减少 21）, 我们得到线性组合
<span class="arithmatex">\(s' \cdot 21 + t' \cdot 26 = 3\)</span>, 其中系数 <span class="arithmatex">\(s'\)</span> 为正. （当然 <span class="arithmatex">\(t'\)</span>
必须为负；否则, 该表达式的值将大于 3. ）</p>
<p>现在我们可以使用容量为 21 和 26 的水壶来得到 3 加仑的水:
我们只需重复以下步骤 <span class="arithmatex">\(s'\)</span> 次:</p>
<p>1. 装满 21 加仑的水壶.</p>
<p>2. 将 21 加仑水壶中的所有水倒入 26 加仑的水壶中. 如果 26
加仑水壶在任何时候变满了, 则将其倒空, 并继续将 21 加仑水壶中的水倒入 26
加仑水壶中.</p>
<p>在这个过程结束时, 我们必须正好倒空 26 加仑的水壶 <span class="arithmatex">\(-t'\)</span> 次. 原因如下:
我们从水源中取了 <span class="arithmatex">\(s' \cdot 21\)</span> 加仑的水, 并且倒出了若干倍的 26 加仑.
如果我们倒空的次数少于 <span class="arithmatex">\(-t'\)</span> 次, 那么根据 (9.6), 大水壶中将至少剩下
<span class="arithmatex">\(3 + 26\)</span> 加仑的水, 这超过了它的容量；如果我们倒空的次数更多,
大水壶中将最多剩下 <span class="arithmatex">\(3 - 26\)</span> 加仑的水, 这是不合理的. 但一旦我们正好倒空
26 加仑的水壶 <span class="arithmatex">\(-t'\)</span> 次, 方程 (9.6) 表明正好剩下 3 加仑的水.</p>
<p>显然, 我们甚至不需要知道系数 <span class="arithmatex">\(s'\)</span> 和 <span class="arithmatex">\(t'\)</span>
就可以使用这种策略！我们可以重复上述步骤, 直到得到 3 加仑的水,
因为这必然会发生. 当然, 我们必须跟踪两个水壶中的水量,
以便知道什么时候完成. 下面是使用这种方法的解决方案, 从空水壶开始, 即
<span class="arithmatex">\((0, 0)\)</span>:</p>
<p><img alt="" src="../images/clipboard-931959954.png" /></p>
<p>同样的方法无论在水壶的容量上还是我们试图得到的水量上都适用！只需重复以下两个步骤,
直到得到所需的水量:</p>
<ol>
<li>装满较小的水壶.</li>
<li>将较小水壶中的所有水倒入较大的水壶中. 如果较大的水壶在任何时候满了,
    则将其倒空, 并继续将较小水壶中的水倒入较大的水壶中.</li>
</ol>
<p>根据之前的推理,
这种方法最终会生成水壶容量最大公约数的每一个倍数——直到较大水壶的容量——所有我们可能得到的数量.
这完全不需要任何技巧！</p>
<p>所以现在我们有了完整的水壶问题解决方案:</p>
<div class="thm">
<h4 id="925">定理 9.2.5</h4>
<p>假设我们有容量为 <span class="arithmatex">\(a\)</span> 和 <span class="arithmatex">\(b\)</span> 的水壶. 对于任何 <span class="arithmatex">\(c \in [0, a]\)</span>,
如果且仅如果 <span class="arithmatex">\(c\)</span> 是 <span class="arithmatex">\(\text{gcd}(a, b)\)</span> 的倍数, 那么可以在容量为 <span class="arithmatex">\(a\)</span>
的水壶中得到 <span class="arithmatex">\(c\)</span> 加仑的水.</p>
</div>
<h3 id="924_1">9.2.4 最大公约数的性质</h3>
<p>了解一些基本的最大公约数性质是很有帮助的:</p>
<div class="lem">
<h4 id="926">引理 9.2.6</h4>
<ol>
<li><span class="arithmatex">\(\text{gcd}(ka, kb) = k \cdot \text{gcd}(a, b)\)</span> 对所有 <span class="arithmatex">\(k &gt; 0\)</span>
    都成立.  </li>
<li><span class="arithmatex">\(d \mid a\)</span> 且 <span class="arithmatex">\(d \mid b\)</span> 当且仅当 <span class="arithmatex">\(d \mid \text{gcd}(a, b)\)</span>.  </li>
<li>如果 <span class="arithmatex">\(\text{gcd}(a, b) = 1\)</span> 且 <span class="arithmatex">\(\text{gcd}(a, c) = 1\)</span>, 则
    <span class="arithmatex">\(\text{gcd}(a, bc) = 1\)</span>.  </li>
<li>如果 <span class="arithmatex">\(a \mid bc\)</span> 且 <span class="arithmatex">\(\text{gcd}(a, b) = 1\)</span>, 则 <span class="arithmatex">\(a \mid c\)</span>.</li>
</ol>
</div>
<p>展示所有这些事实如何从定理 9.2.2（即 gcd
是线性组合）推导出来是一个很好的练习（问题 9.11）.</p>
<p>这些性质也是整数以唯一方式分解为素数的简单结果（定理 9.4.1）.
但我们需要这些事实来证明在第9.4节中的唯一分解性,
因此通过唯一分解性来证明它们会是循环论证.</p>
<h2 id="93">9.3 素数之谜</h2>
<p>在数论中, 一些最大的谜团和见解涉及到素数的性质:</p>
<div class="def">
<h3 id="931">定义 9.3.1</h3>
<p>素数是指大于1且仅能被1和它自身整除的数.
除了0、1和-1以外的非素数称为合数.</p>
</div>
<p>以下是三个著名的谜团:</p>
<h4 id="_4">双素数猜想</h4>
<p>存在无限多的素数 <span class="arithmatex">\(p\)</span>, 使得 <span class="arithmatex">\(p + 2\)</span> 也是素数.</p>
<p>在1966年, 陈景润证明了存在无限多的素数 <span class="arithmatex">\(p\)</span>, 使得 <span class="arithmatex">\(p + 2\)</span>
是至多两个素数的乘积. 因此, 这个猜想被认为几乎是正确的！</p>
<h4 id="_5">因数分解的推测低效性</h4>
<p>给定两个大素数的乘积 <span class="arithmatex">\(n = pq\)</span>, 没有高效的程序能够恢复素数 <span class="arithmatex">\(p\)</span> 和 <span class="arithmatex">\(q\)</span>.
也就是说, 没有多项式时间程序（参见3.5节）能够在以 <span class="arithmatex">\(n\)</span>
的二进制表示长度（而不是 <span class="arithmatex">\(n\)</span> 本身）的多项式范围内找到 <span class="arithmatex">\(p\)</span> 和 <span class="arithmatex">\(q\)</span>.
二进制表示的长度至多是 <span class="arithmatex">\(1 + \log_2 n\)</span>.</p>
<p>已知最好的算法是“数域筛法”, 其运行时间与以下表达式成正比:</p>
<div class="arithmatex">\[
e^{1.9 (\ln n)^{1/3} (\ln \ln n)^{2/3}}. 
\]</div>
<p>这个数增长的速度比 <span class="arithmatex">\(\log n\)</span> 的任何多项式都要快, 当 <span class="arithmatex">\(n\)</span>
有300位数字或更多时是不可行的.</p>
<p>高效的因数分解在计算机科学中具有特别重要的意义,
我们将在本章后面详细解释.</p>
<h4 id="_6">哥德巴赫猜想</h4>
<p>我们已经多次提到哥德巴赫猜想1.1.6: 每个大于2的偶数都等于两个素数的和.
例如, 4 = 2 + 2, 6 = 3 + 3, 8 = 3 + 5, 等等.</p>
<p>在1939年, 施尼勒曼证明了每个偶数都可以写成不超过300,000个素数的和,
这是一个开始. 今天, 我们知道每个偶数最多可以写成6个素数的和.</p>
<p>素数在整数序列中出现得很不规律. 事实上, 它们的分布看起来几乎是随机的: $$
2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41, 43, \ldots
$$</p>
<p>关于素数的一个重要见解是, 它们在整数中的密度有一个精确的极限. 即, 设
<span class="arithmatex">\(\pi(n)\)</span> 表示不超过 <span class="arithmatex">\(n\)</span> 的素数的数量:</p>
<div class="def">
<h4 id="932">定义 9.3.2</h4>
<div class="arithmatex">\[
\pi(n) = |\{p \in [2, n] \mid p \text{ 是素数}\}|
\]</div>
</div>
<p>例如, <span class="arithmatex">\(\pi(1) = 0\)</span>, <span class="arithmatex">\(\pi(2) = 1\)</span> 和 <span class="arithmatex">\(\pi(10) = 4\)</span>,
因为2、3、5和7是小于或等于10的素数. <span class="arithmatex">\(\pi\)</span>
的增长是按照连续素数之间的不规则间隔不规则地增长的,
但它的总体增长率已知会平滑到与函数 <span class="arithmatex">\(n/\ln n\)</span> 的增长相同:</p>
<div class="thm">
<h4 id="933">定理 9.3.3 （素数定理）</h4>
<div class="arithmatex">\[
\lim_{n \to \infty} \frac{\pi(n)}{n / \ln n} = 1
\]</div>
</div>
<p>因此, 素数逐渐减少. 经验法则是, 在 <span class="arithmatex">\(n\)</span> 附近, 每 <span class="arithmatex">\(\ln n\)</span>
个整数中大约有1个素数.</p>
<p>素数定理由勒让德在1798年提出,
并在一个世纪后由德拉瓦莱普桑和阿达玛在1896年证明. 然而,
在高斯去世后发现, 他的一个笔记本中包含了相同的猜想,
他显然在1791年15岁时就已经提出了这个猜想.
（你不得不同情所有那些与高斯同时代的“伟大”数学家, 他们不幸地遇到了高斯.
）</p>
<p>素数定理的证明超出了本文的范围,
但有一个相关结果的可管理证明（见问题9.22）,
该结果对于我们的应用是足够的:</p>
<div class="thm">
<h4 id="934">定理 9.3.4 （切比雪夫的素数密度定理）</h4>
<p>对于 <span class="arithmatex">\(n &gt; 1\)</span>, $$
\pi(n) &gt; \frac{n}{3 \ln n}
$$</p>
</div>
<h2 id="94">9.4 算术基本定理</h2>
<p>关于素数有一个重要的事实, 你可能已经知道: 每个正整数都有唯一的素数分解.
因此, 每个正整数都可以通过唯一的一种方式由素数组成.
这些古怪的素数是整数的构建块.</p>
<p>由于数的乘积的值在数字出现的顺序不同的情况下是相同的,
所以通常没有唯一的方法将一个数表示为素数的乘积. 例如,
有三种方法可以将12写成素数的乘积:</p>
<div class="arithmatex">\[
12 = 2 \cdot 2 \cdot 3 = 2 \cdot 3 \cdot 2 = 3 \cdot 2 \cdot 2. 
\]</div>
<p>关于12的素数分解的独特之处在于,
任何等于12的素数乘积将有且仅有一个3和两个2.
这意味着如果我们按大小排序这些素数, 那么这个乘积确实是唯一的.</p>
<p>让我们更仔细地描述这一点. 当序列中的每个数字至少与它之后的数字一样大时,
这个序列就是弱递减的. 注意,
仅包含一个数字的序列以及不包含数字的序列（即空序列）按照这个定义都是弱递减的.</p>
<div class="thm">
<h4 id="941">定理 9.4.1（算术基本定理）</h4>
<p>每个正整数都是唯一的弱递减素数序列的乘积.</p>
</div>
<p>例如, 75237393 是以下弱递减素数序列的乘积:</p>
<div class="arithmatex">\[
23, 17, 17, 11, 7, 7, 7, 3;
\]</div>
<p>且没有其他弱递减素数序列可以生成75237393.</p>
<p>注意, 如果1被视为素数, 这个定理将是错误的. 例如, 15 可以写成
<span class="arithmatex">\(5 \cdot 3\)</span>, 或者 <span class="arithmatex">\(5 \cdot 3 \cdot 1\)</span>, 或者 <span class="arithmatex">\(5 \cdot 3 \cdot 1 \cdot 1\)</span>,
…</p>
<p>在唯一分解性中有一种奇妙的感觉, 特别是考虑到我们已经提到的素数之谜.
即使你从小就知道这个事实, 也不要认为这是理所当然的. 事实上,
对于许多类似整数的数集, 唯一分解实际上是失效的, 例如形如
<span class="arithmatex">\(n + m\sqrt{-5}\)</span> 的复数（其中 <span class="arithmatex">\(n, m \in \mathbb{Z}\)</span>, 见问题 9.25）.</p>
<p>算术基本定理也被称为唯一分解定理,
这是一个更具描述性且不那么矫饰的名字——但我们真的希望引起你对唯一分解性的重要性和非显而易见性的关注.</p>
<h3 id="941_1">9.4.1 证明唯一分解性</h3>
<p>算术基本定理不难证明, 但我们需要一些初步的事实.</p>
<div class="lem">
<h4 id="942">引理 9.4.2</h4>
<p>如果 <span class="arithmatex">\(p\)</span> 是素数且 <span class="arithmatex">\(p \mid ab\)</span>, 则 <span class="arithmatex">\(p \mid a\)</span> 或 <span class="arithmatex">\(p \mid b\)</span>.</p>
</div>
<p>引理 9.4.2 可以直接从唯一分解性中得到: 乘积 <span class="arithmatex">\(ab\)</span> 中的素数恰好是 <span class="arithmatex">\(a\)</span> 和
<span class="arithmatex">\(b\)</span> 中的素数. 但这样证明引理是作弊的:
我们需要用这个引理来证明唯一分解性, 所以假设它成立将是循环论证. 相反,
我们将使用最大公约数和线性组合的性质来提供一个简单且非循环的证明方法.</p>
<div class="prf">
<p>一种情况是如果 <span class="arithmatex">\(\text{gcd}(a, p) = p\)</span>. 那么命题成立, 因为 <span class="arithmatex">\(a\)</span> 是 <span class="arithmatex">\(p\)</span>
的倍数.</p>
<p>否则, <span class="arithmatex">\(\text{gcd}(a, p) \neq p\)</span>. 在这种情况下, <span class="arithmatex">\(\text{gcd}(a, p)\)</span> 必须是
1, 因为 1 和 <span class="arithmatex">\(p\)</span> 是 <span class="arithmatex">\(p\)</span> 的唯一正除数. 现在 <span class="arithmatex">\(\text{gcd}(a, p)\)</span> 是 <span class="arithmatex">\(a\)</span> 和
<span class="arithmatex">\(p\)</span> 的线性组合, 所以我们有 <span class="arithmatex">\(1 = sa + tp\)</span>, 其中 <span class="arithmatex">\(s, t\)</span> 是一些整数. 那么
<span class="arithmatex">\(b = s(ab) + (tb)p\)</span>, 也就是说, <span class="arithmatex">\(b\)</span> 是 <span class="arithmatex">\(ab\)</span> 和 <span class="arithmatex">\(p\)</span> 的线性组合. 由于 <span class="arithmatex">\(p\)</span>
同时整除 <span class="arithmatex">\(ab\)</span> 和 <span class="arithmatex">\(p\)</span>, 它也整除它们的线性组合 <span class="arithmatex">\(b\)</span>.</p>
</div>
<p>通过常规的归纳论证可以扩展这一陈述:</p>
<div class="lem">
<h4 id="943">引理 9.4.3</h4>
<p>设 <span class="arithmatex">\(p\)</span> 是素数. 如果 <span class="arithmatex">\(p \mid a_1a_2 \cdots a_n\)</span>, 则 <span class="arithmatex">\(p\)</span> 整除某个 <span class="arithmatex">\(a_i\)</span>.</p>
</div>
<p>现在我们准备证明算术基本定理.</p>
<div class="prf">
<p>定理 2.3.1 使用良序原则表明每个正整数都可以表示为素数的乘积.
所以我们只需要证明这种表示是唯一的. 我们将使用良序原则来证明这一点.</p>
<p>证明通过反证法进行: 假设与命题相反,
存在可以以不止一种方式写成素数乘积的正整数. 根据良序原则,
存在具有这种性质的最小整数. 称这个整数为 <span class="arithmatex">\(n\)</span>, 并且令</p>
<div class="arithmatex">\[
n = p_1 \cdot p_2 \cdot \cdots \cdot p_j = q_1 \cdot q_2 \cdots q_k,
\]</div>
<p>其中两个乘积都是弱递减顺序, 并且 <span class="arithmatex">\(p_1 \leq q_1\)</span>.</p>
<p>如果 <span class="arithmatex">\(q_1 = p_1\)</span>, 那么 <span class="arithmatex">\(n / q_1\)</span> 也将是不同弱递减素数序列的乘积, 即</p>
<div class="arithmatex">\[
p_2 \cdots p_j \quad 和 \quad q_2 \cdots q_k. 
\]</div>
<p>由于 <span class="arithmatex">\(n / q_1 &lt; n\)</span>, 这是不可能的, 所以我们得出结论 <span class="arithmatex">\(p_1 &lt; q_1\)</span>.</p>
<p>由于 <span class="arithmatex">\(p_i\)</span> 是弱递减的, 所以所有 <span class="arithmatex">\(p_i\)</span> 都小于 <span class="arithmatex">\(q_1\)</span>. 但</p>
<div class="arithmatex">\[
q_1 \mid n = p_1 \cdot p_2 \cdots p_j, 
\]</div>
<p>所以引理 9.4.3 表明 <span class="arithmatex">\(q_1\)</span> 整除某个 <span class="arithmatex">\(p_i\)</span>, 这与 <span class="arithmatex">\(q_1\)</span> 大于所有 <span class="arithmatex">\(p_i\)</span>
的事实相矛盾.</p>
</div>
<h2 id="95-alan-turing">9.5 Alan Turing</h2>
<p>图9.1中的人物是艾伦·图灵（Alan Turing）, 计算机科学史上最重要的人物.
几十年来, 他那迷人的生活故事被政府的秘密、社会的禁忌,
甚至他自己的欺瞒所掩盖.</p>
<p>在24岁时, 图灵撰写了一篇题为《论可计算数及其在判定问题上的应用》的论文.
论文的关键在于用数学术语来建模计算机的优雅方法. 这是一个突破,
因为它允许将数学工具用于计算问题. 例如, 凭借他的模型,
图灵立即证明了存在一些问题, 无论程序员多么聪明, 任何计算机都无法解决.
图灵的论文更加令人惊叹, 因为他在1936年写这篇论文,
而那时电子计算机还没有出现.</p>
<p>论文标题中的“Entscheidungsproblem”指的是大卫·希尔伯特（David
Hilbert）在1900年提出的28个数学问题之一, 作为对20世纪数学家的挑战.
图灵在同一篇论文中解决了这个问题.
你或许听说过“丘奇-图灵论题”？也是在这篇论文中提出的.
所以图灵是一个才华横溢的人, 他提出了许多令人惊叹的想法.
但这次讲座涉及的是图灵的一个不那么惊人的想法. 它涉及编码, 涉及数论,
并且有点愚蠢.</p>
<p>让我们回到1937年秋天. 纳粹德国在阿道夫·希特勒的领导下重新武装,
世界大战看起来迫在眉睫, 艾伦·图灵也在思考数论的用处.
他预见到在即将到来的冲突中, 保守军事机密将至关重要,
并提出了一种使用数论来加密通信的方法. 这是一个跨时代的想法. 今天,
数论是众多公钥密码系统、数字签名方案、加密哈希函数和电子支付系统的基础.
此外, 军事资助机构是加密研究的最大投资者之一. 对不起, 哈代（Hardy）！</p>
<p>在设计出他的编码系统后不久, 图灵从公众视野中消失了, 半个世纪后,
世界才知道他去了哪里以及在那里做了什么. 我们稍后会回到图灵的生活；现在,
让我们来探讨图灵留下的代码. 由于他从未正式发表过这个想法, 细节尚不确定,
所以我们将考虑几种可能性.</p>
<p><img alt="" src="../images/clipboard-1184507317.png" /></p>
<h3 id="951-10">9.5.1 图灵密码（版本1.0）</h3>
<p>第一个挑战是将文本消息转换为整数, 以便我们可以对其执行数学操作.
此步骤并不打算使消息更难以阅读, 因此细节并不太重要. 这里有一种方法:
用两位数字替换消息中的每个字母（A = 01, B = 02, C = 03, 等等）,
并将所有数字串在一起形成一个巨大的数字. 例如, 消息“victory”可以这样翻译:</p>
<div class="arithmatex">\[
\begin{aligned}
&amp;v \quad &amp;i \quad &amp;c \quad &amp;t \quad &amp;o \quad &amp;r \quad &amp;y \\
&amp;22 \quad &amp;09 \quad &amp;03 \quad &amp;20 \quad &amp;15 \quad &amp;18 \quad &amp;25
\end{aligned}
\]</div>
<p>图灵的密码要求消息是一个素数,
因此我们可能需要用一些更多的数字来填充结果以使其成为素数. 素数定理表明,
用相对较少的数字填充就可以. 比如,
在数字13后面加上数字“2209032015182513”即是素数.</p>
<p>以下是加密过程的工作原理. 在下面的描述中, <span class="arithmatex">\(m\)</span>
是未编码的消息（我们想要保密的）, <span class="arithmatex">\(\hat{m}\)</span>
是加密后的消息（纳粹可能截获）, <span class="arithmatex">\(k\)</span> 是密钥.</p>
<p><strong>预先准备</strong>: 发送者和接收者同意一个密钥, 这是一个大素数 <span class="arithmatex">\(k\)</span>.</p>
<p><strong>加密</strong>: 发送者通过计算 <span class="arithmatex">\(\hat{m} = m \cdot k\)</span> 加密消息 <span class="arithmatex">\(m\)</span>.</p>
<p><strong>解密</strong>: 接收者通过计算 <span class="arithmatex">\(\frac{\hat{m}}{k} = m\)</span> 解密 <span class="arithmatex">\(\hat{m}\)</span>.</p>
<p>例如, 假设密钥是素数 <span class="arithmatex">\(k = 22801763489\)</span>, 消息 <span class="arithmatex">\(m\)</span> 是“victory”.
则加密消息为:</p>
<div class="arithmatex">\[
\hat{m} = m \cdot k \\
= 2209032015182513 \cdot 22801763489 \\
= 50369825549820718594667857
\]</div>
<p>关于图灵密码, 有几个基本问题需要回答:</p>
<ol>
<li>
<p><strong>发送者和接收者如何确保</strong> <span class="arithmatex">\(m\)</span> 和 <span class="arithmatex">\(k\)</span> 是素数, 如要求的那样？</p>
<p>确定一个大数是否为素数或合数的问题已经研究了几个世纪,
在实践中使用的素数测试在图灵的时代就已知. 在过去的几十年里,
发现了非常快速的素数测试方法, 如下所述.</p>
</li>
</ol>
<blockquote>
<p><strong>素数测试</strong></p>
<p>很容易看出, 整数 <span class="arithmatex">\(n\)</span> 是素数当且仅当它不能被从 <span class="arithmatex">\(2\)</span> 到
<span class="arithmatex">\(\lfloor \sqrt{n} \rfloor\)</span> 之间的任何数整除（参见问题 1.14）. 当然,
这种测试 <span class="arithmatex">\(n\)</span> 是否为素数的简单方法需要超过 <span class="arithmatex">\(\sqrt{n}\)</span> 步, 这是以 <span class="arithmatex">\(n\)</span>
的大小（以 <span class="arithmatex">\(n\)</span> 的十进制或二进制表示的数字位数来衡量）呈指数增长的步骤.
在1970年代初期之前, 没有已知的素数测试程序不会出现这样的问题.</p>
<p>1974年, 沃尔克·斯特拉森发明了一种简单、快速的概率素数测试.
斯特拉森的测试在应用于任何素数时给出正确答案,
但在非素数上有一定概率给出错误答案. 然而,
给定数字上给出错误答案的概率如此之小,
以至于依赖该答案是你能做的最好的选择.</p>
<p>即使如此,
错误答案的理论可能性也是令人困扰的——即使错误的概率远低于计算机硬件错误导致错误答案的概率.</p>
<p>最终在2002年, 在一篇以引用高斯强调素数测试的重要性和古老性的论文中,
Manindra Agrawal、Neeraj Kayal 和 Nitin Saxena
提出了一个惊人的十三行描述的多项式时间素数测试.</p>
<p>这最终将素数测试大大低于显然需要的SAT和类似问题的指数努力. Agrawal
等人的测试的多项式上界为12, 随后研究将次数减少到5,
但这仍然太大而不切实际, 概率素数测试仍然是今天使用的方法.
可能次数上界还可以再减少一些,
但匹配已知的概率测试的速度仍然是一个令人生畏的挑战.</p>
</blockquote>
<ol>
<li>
<p><strong>图灵密码是否安全？</strong></p>
<p>纳粹只能看到加密消息 <span class="arithmatex">\(\hat{m} = m \cdot k\)</span>, 因此恢复原始消息 <span class="arithmatex">\(m\)</span>
需要因式分解 <span class="arithmatex">\(\hat{m}\)</span>. 尽管有无数次尝试,
但还没有发现真正高效的因式分解算法. 看来这是一个根本上困难的问题.
因此, 尽管某天可能会有突破,
但普遍接受的猜想是没有高效的方法来进行因式分解. 实际上,
图灵的密码将他的发现付诸实践, 即计算能力是有限的. 因此, 只要 <span class="arithmatex">\(m\)</span> 和
<span class="arithmatex">\(k\)</span> 足够大, 纳粹似乎就没有希望了！</p>
</li>
</ol>
<p>这些听起来都很有前途, 但图灵的密码有一个重大缺陷.</p>
<h3 id="952-10">9.5.2 破解图灵的密码（版本1.0）</h3>
<p>让我们考虑当发送者使用图灵的密码和相同的密钥发送第二条消息时会发生什么.
这给了纳粹两个加密消息:</p>
<div class="arithmatex">\[
\hat{m}_1 = m_1 \cdot k \quad \text{和} \quad \hat{m}_2 = m_2 \cdot k
\]</div>
<p>两个加密消息 <span class="arithmatex">\(\hat{m}_1\)</span> 和 <span class="arithmatex">\(\hat{m}_2\)</span> 的最大公约数是密钥 <span class="arithmatex">\(k\)</span>.
正如我们所见, 两个数的最大公约数可以非常高效地计算.
所以在发送第二条消息后, 纳粹可以恢复密钥并读取每条消息！</p>
<p>像图灵这样才华横溢的数学家不太可能忽视这样一个明显的问题,
我们可以猜测他考虑了一个稍有不同的系统, 基于模运算的系统.</p>
<h2 id="96">9.6 模运算</h2>
<p>在他关于数论的名著《算术研究》的第一页, 高斯引入了“同余”的概念.
高斯是另一个总能时不时提出一个不错的想法的人, 所以让我们来看看这个.
高斯说, 如果 <span class="arithmatex">\(n \mid (a - b)\)</span>, 那么 <span class="arithmatex">\(a\)</span> 同余于 <span class="arithmatex">\(b\)</span> 模 <span class="arithmatex">\(n\)</span>. 这写作</p>
<div class="arithmatex">\[
a \equiv b \pmod{n}. 
\]</div>
<p>例如:</p>
<div class="arithmatex">\[
29 \equiv 15 \pmod{7}, 因为 7 \mid (29 - 15). 
\]</div>
<p>不允许模数 <span class="arithmatex">\(n \leq 0\)</span> 是没有用的, 所以我们将假设从现在起模数是正数.</p>
<p>同余与余数之间有紧密的联系:</p>
<div class="lem">
<h4 id="961">引理 9.6.1 （余数）</h4>
<div class="arithmatex">\[
a \equiv b \pmod{n} \iff \text{rem}(a, n) = \text{rem}(b, n). 
\]</div>
</div>
<div class="prf">
<p>根据除法定理 9.1.4, 存在唯一的整数对 <span class="arithmatex">\(q_1, r_1\)</span> 和 <span class="arithmatex">\(q_2, r_2\)</span>, 使得:</p>
<div class="arithmatex">\[
a = q_1 n + r_1 \\
b = q_2 n + r_2, 
\]</div>
<p>其中 <span class="arithmatex">\(r_1, r_2 \in [0, n)\)</span>. 从第一个等式减去第二个等式得:</p>
<div class="arithmatex">\[
a - b = (q_1 - q_2)n + (r_1 - r_2), 
\]</div>
<p>其中 <span class="arithmatex">\(r_1 - r_2\)</span> 在区间 <span class="arithmatex">\((-n, n)\)</span> 内. 现在 <span class="arithmatex">\(a \equiv b \pmod{n}\)</span>
当且仅当 <span class="arithmatex">\(n\)</span> 整除此等式的左侧. 这仅当且仅当 <span class="arithmatex">\(r_1 - r_2\)</span> 是 <span class="arithmatex">\(n\)</span>
的倍数时成立. 但是在 <span class="arithmatex">\((-n, n)\)</span> 内的唯一 <span class="arithmatex">\(n\)</span> 的倍数是 0, 所以 <span class="arithmatex">\(r_1 - r_2\)</span>
必须事实上等于 0, 即当 <span class="arithmatex">\(r_1 = \text{rem}(a, n) = r_2 = \text{rem}(b, n)\)</span>
时.</p>
</div>
<p>因此我们也可以看到</p>
<div class="arithmatex">\[
29 \equiv 15 \pmod{7} 因为 \text{rem}(29, 7) = 1 = \text{rem}(15, 7). 
\]</div>
<p>注意, 即使“<span class="arithmatex">\(\pmod{7}\)</span>”出现在末尾, <span class="arithmatex">\(\equiv\)</span> 符号与29的关联并不比与15的强.
这可能更清楚地写成 <span class="arithmatex">\(29 \equiv_{7} 15\)</span>, 例如,
但带有模数的符号在末尾的表示法已牢固确立, 我们就这样吧.</p>
<p>余数引理 9.6.1 解释了为什么同余关系具有类似于等式关系的性质. 特别是,
以下性质立即成立:</p>
<div class="lem">
<h4 id="962">引理 9.6.2</h4>
<div class="arithmatex">\[
\begin{aligned}
&amp;a \equiv a \pmod{n} \quad &amp;\text{（自反性）} \\
&amp;a \equiv b \iff b \equiv a \pmod{n} \quad &amp;\text{（对称性）} \\
&amp;(a \equiv b \text{ 且 } b \equiv c) \implies a \equiv c \pmod{n} \quad &amp;\text{（传递性）}
\end{aligned}
\]</div>
</div>
<p>我们将经常使用余数引理 9.6.1 的另一个直接推论:</p>
<div class="cor">
<h4 id="963">推论 9.6.3</h4>
<div class="arithmatex">\[
a \equiv \text{rem}(a, n) \pmod{n}
\]</div>
</div>
<p>考虑同余模 <span class="arithmatex">\(n\)</span> 的另一种方法是, 它将整数划分为 <span class="arithmatex">\(n\)</span> 个集合,
使得同余的数都在同一个集合中. 例如, 假设我们以模3工作.
然后我们可以将整数划分为3个集合如下:</p>
<div class="arithmatex">\[
\begin{aligned}
&amp;\{ \ldots, -6, -3, 0, 3, 6, 9, \ldots \} \\
&amp;\{ \ldots, -5, -2, 1, 4, 7, 10, \ldots \} \\
&amp;\{ \ldots, -4, -1, 2, 5, 8, 11, \ldots \}
\end{aligned}
\]</div>
<p>根据它们除以3的余数是0、1或2. 这意味着当算术在模 <span class="arithmatex">\(n\)</span> 下进行时,
实际上只有 <span class="arithmatex">\(n\)</span> 种不同类型的数要担心, 因为只有 <span class="arithmatex">\(n\)</span> 个可能的余数.
从这个意义上说, 模运算是普通算术的简化.</p>
<p>关于同余的下一个最有用的事实是它们在加法和乘法下是保持的:</p>
<div class="lem">
<h4 id="964">引理 9.6.4 （同余）</h4>
<p>如果 <span class="arithmatex">\(a \equiv b \pmod{n}\)</span> 和 <span class="arithmatex">\(c \equiv d \pmod{n}\)</span>, 则</p>
<div class="arithmatex">\[
a + c \equiv b + d \pmod{n}, \\
ac \equiv bd \pmod{n}. 
\]</div>
</div>
<div class="prf">
<p>我们从 9.7 开始. 因为 <span class="arithmatex">\(a \equiv b \pmod{n}\)</span>, 根据定义有</p>
<div class="arithmatex">\[
n \mid (b - a) = (b + c) - (a + c), 
\]</div>
<p>所以</p>
<div class="arithmatex">\[
a + c \equiv b + d \pmod{n}. 
\]</div>
<p>因为 <span class="arithmatex">\(c \equiv d \pmod{n}\)</span>, 同样的推理导致</p>
<div class="arithmatex">\[
b + c \equiv b + d \pmod{n}. 
\]</div>
<p>现在, 传递性（引理 9.6.2）给出</p>
<div class="arithmatex">\[
a + c \equiv b + d \pmod{n}. 
\]</div>
<p>9.8 的证明几乎是相同的, 利用的事实是, 如果 <span class="arithmatex">\(n \mid (b - a)\)</span>,
则它当然也整除 <span class="arithmatex">\((bc - ac)\)</span>.</p>
</div>
<h2 id="97">9.7 余数算术</h2>
<p>同余引理 9.6.1 表明, 当且仅当两个数的余数相等时, 它们是同余的,
所以我们可以通过处理余数的算术来理解同余.
如果我们只想要某些数进行一系列加法、乘法、减法后的模 <span class="arithmatex">\(n\)</span> 的余数,
我们可以在每一步都取余数, 这样整个计算只涉及范围 <span class="arithmatex">\([0..n)\)</span> 内的数.</p>
<h3 id="_7">余数算术的一般原则</h3>
<p>要找到某些整数进行一系列加法和乘法运算后除以 <span class="arithmatex">\(n\)</span> 的余数: -
用每个整数操作数除以 <span class="arithmatex">\(n\)</span> 的余数替换它. - 通过立即用除以 <span class="arithmatex">\(n\)</span>
的余数替换范围外的任何结果, 将每次加法或乘法的结果保持在 <span class="arithmatex">\([0..n)\)</span>
的范围内.</p>
<p>例如, 假设我们想找到</p>
<div class="arithmatex">\[
\text{rem}((44427^{3456789} + 15555858^{5555})^{4036666666}, 36).  \tag{9.9}
\]</div>
<p>如果你考虑计算这些大幂次然后取余数, 这看起来非常令人畏惧. 例如,
<span class="arithmatex">\(44427^{3456789}\)</span> 的十进制表示约有2000万位, 所以我们当然不想走这条路.
但记住整数指数指定了一系列乘法, 我们遵循一般原则并用乘数的余数替换它们.
由于 <span class="arithmatex">\(\text{rem}(44427, 36) = 3\)</span>, <span class="arithmatex">\(\text{rem}(15555858, 36) = 6\)</span>,
<span class="arithmatex">\(\text{rem}(403, 36) = 7\)</span>, 我们发现 (9.9) 等于</p>
<div class="arithmatex">\[
\text{rem}((3^{3456789} + 6^{5555})7^{6666666}, 36).  \tag{9.10}
\]</div>
<p>这稍微好一些, 但 <span class="arithmatex">\(3^{3456789}\)</span> 的十进制表示约有一百万位,
所以我们仍然不想计算它. 但让我们看看3的前几次幂的余数:</p>
<div class="arithmatex">\[
\text{rem}(3, 36) = 3 \\
\text{rem}(3^2, 36) = 9 \\
\text{rem}(3^3, 36) = 27 \\
\text{rem}(3^4, 36) = 9. 
\]</div>
<p>在仅仅两步之后我们得到了第二步的重复, <span class="arithmatex">\(\text{rem}(3^2, 36)\)</span>, 这意味着从
<span class="arithmatex">\(3^2\)</span> 开始, 连续幂的余数序列每两步重复一次. 因此,
至少三个3的幂的乘积在模36时将具有与仅三个3的乘积相同的余数. 因此,</p>
<div class="arithmatex">\[
\text{rem}(3^{3456789}, 36) = \text{rem}(3^3, 36) = 27. 
\]</div>
<p>注意, 将指数替换为其余数将是一个灾难性的错误.
一般原则适用于作为加法和乘法操作数的数字,
而指数是控制执行多少次乘法的数字. 注意这一点.</p>
<h3 id="971-mathbb-z_n">9.7.1 整数环<span class="arithmatex">\(\mathbb Z_n\)</span></h3>
<p>现在是更准确地解释一般原则及其工作原理的时候了. 首先, 让我们引入符号
<span class="arithmatex">\(+_n\)</span>表示加法后立即对 <span class="arithmatex">\(n\)</span> 取余数, 如一般原则所规定的; 同样, 乘法用
<span class="arithmatex">\(\cdot n\)</span> 表示:</p>
<div class="arithmatex">\[
\begin{aligned}
i+{ }_n j &amp; :=\operatorname{rem}(i+j, n), \\
i \cdot{ }_n j &amp; :=\operatorname{rem}(i j, n)
\end{aligned}
\]</div>
<p>现在, 一般原则只是以下引理的重复应用.</p>
<div class="lem">
<h4 id="971">引理 9.7.1</h4>
<div class="arithmatex">\[
\begin{align}
\text{rem}(i + j, n) = \text{rem}(i, n) +_n \text{rem}(j, n),  \tag{9.11} \\
\text{rem}(ij, n) = \text{rem}(i, n) \cdot_n \text{rem}(j, n).  \tag{9.12}
\end{align}
\]</div>
</div>
<div class="prf">
<p>根据推论 9.6.3, <span class="arithmatex">\(i \equiv \text{rem}(i, n)\)</span> 和
<span class="arithmatex">\(j \equiv \text{rem}(j, n)\)</span>, 因此根据同余引理 9.6.4,</p>
<div class="arithmatex">\[
i + j \equiv \text{rem}(i, n) + \text{rem}(j, n) \pmod{n}. 
\]</div>
<p>根据推论 9.6.3, 再次, 余数等式两边的余数相等, 这立即给出 (9.11).
类似的证明适用于 (9.12).</p>
</div>
<p>在范围 <span class="arithmatex">\([0..n)\)</span> 内的整数集合及运算 <span class="arithmatex">\(+_n\)</span> 和 <span class="arithmatex">\(\cdot_n\)</span> 被称为 <span class="arithmatex">\(Z_n\)</span>, 即模
<span class="arithmatex">\(n\)</span> 的整数环. 作为引理 9.7.1 的结果, 熟悉的算术规则在 <span class="arithmatex">\(Z_n\)</span> 中成立,
例如:</p>
<div class="arithmatex">\[
(i \cdot_n j) \cdot_n k = i \cdot_n (j \cdot_n k). 
\]</div>
<p>这些下标的 <span class="arithmatex">\(n\)</span> 在算术操作中确实使事情变得复杂,
因此我们将在一旁写“<span class="arithmatex">\((Z_n)\)</span>”来得到看起来更简洁的方程:</p>
<div class="arithmatex">\[
(i \cdot j) \cdot k = i \cdot (j \cdot k) \quad (Z_n). 
\]</div>
<p>特别是, 以下所有等式在 <span class="arithmatex">\(Z_n\)</span> 中成立:</p>
<div class="arithmatex">\[
\begin{aligned}
&amp;(i \cdot j) \cdot k = i \cdot (j \cdot k) \quad &amp;\text{（乘法的结合律）} \\
&amp;(i + j) + k = i + (j + k) \quad &amp;\text{（加法的结合律）} \\
&amp;1 \cdot k = k \quad &amp;\text{（乘法的恒等性）} \\
&amp;0 + k = k \quad &amp;\text{（加法的恒等性）} \\
&amp;k + (-k) = 0 \quad &amp;\text{（加法的逆元）} \\
&amp;i + j = j + i \quad &amp;\text{（加法的交换律）} \\
&amp;i \cdot (j + k) = (i \cdot j) + (i \cdot k) \quad &amp;\text{（分配律）} \\
&amp;i \cdot j = j \cdot i \quad &amp;\text{（乘法的交换律）}
\end{aligned}
\]</div>
<p>结合律表明, 省略乘积中的括号是安全的:</p>
<div class="arithmatex">\[
k_1 \cdot k_2 \cdot \cdots \cdot k_m
\]</div>
<p>无论如何加括号, 在 <span class="arithmatex">\(Z_n\)</span> 中结果都是相同的.</p>
<p>总体主题是, 余数算术与普通算术非常相似.
但有一些例外情况需要我们进行探讨.</p>
<h2 id="98-20">9.8 图灵的密码（版本2.0）</h2>
<p>1940年, 法国在希特勒的军队面前沦陷, 英国独自对抗西欧的纳粹.
英国的抵抗依赖于从美国通过船队横跨北大西洋运来的稳定供应.
这些船队与德国“U型潜艇”玩猫捉老鼠的游戏, 潜艇在大西洋徘徊,
试图击沉补给船, 使英国在饥饿中屈服. 这场斗争的结果取决于信息的平衡:
德国人能否比盟军更好地定位船队, 还是相反？德国输了.</p>
<p>德国失败的一个关键原因直到1974年才公之于众:
德国的海军密码Enigma被波兰密码局破译,
并在1939年波兰被纳粹入侵前几周移交给英国. 在战争的大部分时间里,
盟军通过监听德国通信绕过德国潜艇.
英国政府直到1996年才解释Enigma是如何被破译的.
当这个故事最终被（由美国）公布时,
揭示了艾伦·图灵于1939年加入了布莱切利公园的秘密英国破译工作,
在那里他成为快速、大规模解密德国Enigma信息的方法的主要开发者.
图灵对Enigma的解密对盟军战胜希特勒做出了不可估量的贡献.</p>
<p>各国政府对密码学总是守口如瓶,
但战后半个世纪关于图灵在破译Enigma和拯救英国方面的作用的官方沉默可能与一些令人不安的事件有关——稍后再说.
让我们回到数论, 考虑对图灵密码的一种替代解释.
也许我们的基本思路是对的（将消息乘以密钥）,
但错误在于使用了常规算术而不是模运算. 也许这就是图灵的意思:</p>
<p><strong>预先准备</strong>: 发送者和接收者同意一个大数 <span class="arithmatex">\(n\)</span>, 这可以公开.
（这将是我们所有算术运算的模数. ）如同版本1.0, 他们还同意一些素数
<span class="arithmatex">\(k &lt; n\)</span> 将是秘密密钥.</p>
<p><strong>加密</strong>: 如同版本1.0, 消息 <span class="arithmatex">\(m\)</span> 应该是另一个在 <span class="arithmatex">\([0..n)\)</span> 中的素数.
发送者通过计算 <span class="arithmatex">\(mk\)</span> 生成加密消息, 但这次取模 <span class="arithmatex">\(n\)</span>:</p>
<div class="arithmatex">\[
\hat{m} := m \cdot k \pmod{n} \tag{9.13}
\]</div>
<p><strong>解密</strong>: 解密步骤是一个问题. 我们可能希望通过将加密消息 <span class="arithmatex">\(\hat{m}\)</span>
除以密钥 <span class="arithmatex">\(k\)</span> 来解密消息. 问题在于 <span class="arithmatex">\(\hat{m}\)</span> 是 <span class="arithmatex">\(mk\)</span> 除以 <span class="arithmatex">\(n\)</span> 的余数.
因此, 将 <span class="arithmatex">\(\hat{m}\)</span> 除以 <span class="arithmatex">\(k\)</span> 可能甚至不会给我们一个整数！</p>
<p>这个解码难题可以通过更好地理解在模运算中何时可以除以 <span class="arithmatex">\(k\)</span> 来解决.</p>
<h2 id="99">9.9 乘法逆元和消去</h2>
<p>一个数 <span class="arithmatex">\(x\)</span> 的乘法逆元是另一个数 <span class="arithmatex">\(x^{-1}\)</span>, 使得</p>
<div class="arithmatex">\[
x^{-1} \cdot x = 1. 
\]</div>
<p>从现在起, 当我们说“逆元”时, 我们指的是乘法逆元（不是关系逆元）.</p>
<p>例如, 在有理数中, 1/3 当然是3的逆元, 因为</p>
<div class="arithmatex">\[
\frac{1}{3} \cdot 3 = 1. 
\]</div>
<p>事实上, 除了0之外, 每个有理数 <span class="arithmatex">\(n/m\)</span> 都有一个逆元, 即 <span class="arithmatex">\(m/n\)</span>. 另一方面,
在整数中, 只有1和-1有逆元. 在环 <span class="arithmatex">\(Z_n\)</span> 中, 情况变得有点复杂. 例如, 2 是
<span class="arithmatex">\(Z_{15}\)</span> 中 8 的乘法逆元, 因为</p>
<div class="arithmatex">\[
2 \cdot 8 = 1 \quad (Z_{15}). 
\]</div>
<p>另一方面, 3 在 <span class="arithmatex">\(Z_{15}\)</span> 中没有乘法逆元. 我们可以通过反证法证明这一点:
假设存在一个 3 的逆元 <span class="arithmatex">\(j\)</span>, 即</p>
<div class="arithmatex">\[
1 = 3 \cdot j \quad (Z_{15}). 
\]</div>
<p>然后两边乘以 5 会直接导致矛盾</p>
<div class="arithmatex">\[
\begin{align}
5 &amp;= 5 \cdot (3 \cdot j) \\
&amp;= (5 \cdot 3) \cdot j \\
&amp;= 0 \cdot j = 0 \quad (Z_{15}). 
\end{align}
\]</div>
<p>因此不可能有这样的逆元 <span class="arithmatex">\(j\)</span>.</p>
<p>因此, 一些数在模 15 下有逆元, 而其他数没有. 这可能让人感到有点不安,
但有一个简单的解释.</p>
<h3 id="991">9.9.1 互素</h3>
<p>没有公因数（素数或非素数）的整数称为互素.
这与没有大于1的公因数（素数或非素数）相同. 也等价于说
<span class="arithmatex">\(\text{gcd}(a, b) = 1\)</span>.</p>
<p>例如, 8和15是互素的, 因为 <span class="arithmatex">\(\text{gcd}(8, 15) = 1\)</span>. 另一方面,
3和15不是互素的, 因为 <span class="arithmatex">\(\text{gcd}(3, 15) = 3 \neq 1\)</span>. 这解释了为什么8在
<span class="arithmatex">\(Z_{15}\)</span> 中有逆元, 而3没有.</p>
<div class="lem">
<h4 id="991_1">引理 9.9.1</h4>
<p>如果 <span class="arithmatex">\(k \in [0..n)\)</span> 与 <span class="arithmatex">\(n\)</span> 互素, 则 <span class="arithmatex">\(k\)</span> 在 <span class="arithmatex">\(Z_n\)</span> 中有逆元.</p>
</div>
<div class="prf">
<p>如果 <span class="arithmatex">\(k\)</span> 与 <span class="arithmatex">\(n\)</span> 互素, 则 <span class="arithmatex">\(\text{gcd}(n, k) = 1\)</span> 根据最大公约数的定义.
这意味着我们可以使用 9.2.2 节中的碎石机找到 <span class="arithmatex">\(n\)</span> 和 <span class="arithmatex">\(k\)</span> 的线性组合等于1:</p>
<div class="arithmatex">\[
sn + tk = 1. 
\]</div>
<p>因此应用余数算术的一般原则（引理 9.7.1）, 我们得到</p>
<div class="arithmatex">\[
\text{rem}(s, n) \cdot \text{rem}(n, n) + (\text{rem}(t, n) \cdot \text{rem}(k, n)) = 1 \quad (Z_n). 
\]</div>
<p>但 <span class="arithmatex">\(\text{rem}(n, n) = 0\)</span>, 并且 <span class="arithmatex">\(\text{rem}(k, n) = k\)</span> 因为
<span class="arithmatex">\(k \in [0..n)\)</span>, 因此我们得到</p>
<div class="arithmatex">\[
\text{rem}(t, n) \cdot k = 1 \quad (Z_n). 
\]</div>
<p>因此, <span class="arithmatex">\(\text{rem}(t, n)\)</span> 是 <span class="arithmatex">\(k\)</span> 的乘法逆元.</p>
</div>
<p>顺便说一句, 知道逆元存在时它们是唯一的也很好. 也就是说,</p>
<div class="lem">
<h4 id="992">引理 9.9.2</h4>
<p>如果 <span class="arithmatex">\(i\)</span> 和 <span class="arithmatex">\(j\)</span> 都是 <span class="arithmatex">\(Z_n\)</span> 中 <span class="arithmatex">\(k\)</span> 的逆元, 则 <span class="arithmatex">\(i = j\)</span>.</p>
</div>
<div class="prf">
<div class="arithmatex">\[
i = i \cdot 1 = i \cdot (k \cdot j) = (i \cdot k) \cdot j = 1 \cdot j = j \quad (Z_n). 
\]</div>
</div>
<p>所以引理 9.9.1 的证明表明, 对于任何与 <span class="arithmatex">\(n\)</span> 互素的 <span class="arithmatex">\(k\)</span>, <span class="arithmatex">\(Z_n\)</span> 中 <span class="arithmatex">\(k\)</span>
的逆元只是我们可以使用碎石机轻松找到的系数的余数.</p>
<p>在这里使用素数模数是有吸引力的, 因为与有理数和实数类似, 当 <span class="arithmatex">\(p\)</span> 是素数时,
每个非零数在 <span class="arithmatex">\(Z_p\)</span> 中都有逆元.
但模合数的算术运算实际上只是比模素数运算稍微麻烦一点——虽然你可能认为这就像医生说的,
“这只会痛一点”, 在他把一根大针头扎进你的手臂之前.</p>
<h2 id="992_1">9.9.2 消去</h2>
<p>另一个实数的优点是可以消去公因数. 换句话说, 如果我们知道对于实数
<span class="arithmatex">\(r, s, t\)</span>, 有 <span class="arithmatex">\(tr = ts\)</span>, 那么只要 <span class="arithmatex">\(t \neq 0\)</span>, 我们就可以消去 <span class="arithmatex">\(t\)</span>, 得出
<span class="arithmatex">\(r = s\)</span>. 一般来说, 在 <span class="arithmatex">\(Z_n\)</span> 中, 消去是不成立的. 例如,</p>
<div class="arithmatex">\[
3 \cdot 10 = 3 \cdot 5 \quad (Z_{15}),  \quad (9.14)
\]</div>
<p>但消去3会导致荒谬的结论: 10等于5.</p>
<p>乘法项不能消去这一事实是 <span class="arithmatex">\(Z_n\)</span> 算术与普通整数算术不同的最显著方式.</p>
<div class="def">
<h4 id="993">定义 9.9.3</h4>
<p>如果 <span class="arithmatex">\(k \cdot a = k \cdot b\)</span> 意味着 <span class="arithmatex">\(a = b\)</span> <span class="arithmatex">\((Z_n)\)</span>, 则数 <span class="arithmatex">\(k\)</span> 在 <span class="arithmatex">\(Z_n\)</span>
中是可消去的, 对所有 <span class="arithmatex">\(a, b \in [0..n)\)</span> 成立.</p>
</div>
<p>如果一个数与15是互素的, 则可以通过乘以它的逆元来消去. 因此,
消去适用于具有逆元的数:</p>
<div class="lem">
<h4 id="994">引理 9.9.4</h4>
<p>如果 <span class="arithmatex">\(k\)</span> 在 <span class="arithmatex">\(Z_n\)</span> 中有逆元, 那么它是可消去的.</p>
</div>
<p>但3不是与15互素的, 这就是为什么它不可消去. 更一般地说, 如果 <span class="arithmatex">\(k\)</span> 不与 <span class="arithmatex">\(n\)</span>
互素, 那么我们可以像在 (9.14) 中展示的那样证明它在 <span class="arithmatex">\(Z_n\)</span> 中不可消去.</p>
<p>总结如下:</p>
<div class="thm">
<h4 id="995">定理 9.9.5</h4>
<p>对于 <span class="arithmatex">\(k \in [0..n)\)</span>, 以下条件是等价的:</p>
<div class="arithmatex">\[
\begin{align}
&amp;\text{gcd}(k, n) = 1,  \\
&amp;k \text{ 在 } Z_n \text{ 中有逆元, } \\
&amp;k \text{ 在 } Z_n \text{ 中是可消去的. }
\end{align}
\]</div>
</div>
<h3 id="993-20">9.9.3 解密（版本2.0）</h3>
<p>乘法逆元是图灵密码解密的关键. 具体来说, 我们可以通过将编码消息乘以密钥的
<span class="arithmatex">\(Z_n\)</span> 逆元来恢复原始消息:</p>
<div class="arithmatex">\[
\hat{m} \cdot j = (m \cdot k) \cdot j = m \cdot (k \cdot j) = m \cdot 1 = m \quad (Z_n). 
\]</div>
<p>因此, 我们只需要找到秘密密钥 <span class="arithmatex">\(k\)</span> 的逆元,
这对于我们来说将很容易使用碎石机——前提是 <span class="arithmatex">\(k\)</span> 有逆元. 但 <span class="arithmatex">\(k\)</span>
是正数且小于模数 <span class="arithmatex">\(n\)</span>, 因此确保 <span class="arithmatex">\(k\)</span> 与模数 <span class="arithmatex">\(n\)</span> 互素的一种简单方法是让 <span class="arithmatex">\(n\)</span>
为一个素数.</p>
<h3 id="994-20">9.9.4 破解图灵密码（版本2.0）</h3>
<p>德国人没有费心使用高度安全的Enigma系统来加密天气预报. 毕竟,
如果盟军知道冰岛南海岸有雨, 又如何呢？但令人惊讶的是,
这种做法在1941年的大西洋海战中为英国提供了一个关键的优势.</p>
<p>问题在于一些天气报告最初是通过Enigma从大西洋上的U型潜艇传输的. 因此,
英国获得了未加密的报告和使用Enigma加密的相同报告. 通过比较两者,
英国人能够确定德国人那天使用的密钥, 并可以读取所有其他Enigma编码的通信.
今天, 这将被称为已知明文攻击.</p>
<p>让我们看看已知明文攻击如何对图灵的密码起作用. 假设纳粹知道明文 <span class="arithmatex">\(m\)</span> 及其</p>
<div class="arithmatex">\[
\hat{m} = m \cdot k \quad (Z_n). 
\]</div>
<p>由于 <span class="arithmatex">\(m\)</span> 是正数且小于素数 <span class="arithmatex">\(n\)</span>, 纳粹可以使用碎石机找到 <span class="arithmatex">\(m\)</span> 的 <span class="arithmatex">\(Z_n\)</span> 逆元
<span class="arithmatex">\(j\)</span>. 现在</p>
<div class="arithmatex">\[
j \cdot \hat{m} = j \cdot (m \cdot k) = (j \cdot m) \cdot k = 1 \cdot k = k \quad (Z_n). 
\]</div>
<p>因此, 通过计算 <span class="arithmatex">\(j \cdot \hat{m} \quad (Z_n)\)</span>,
纳粹获得秘密密钥并可以解密任何消息！</p>
<p>这是一个巨大的漏洞, 因此图灵的假想版本2.0密码没有实际价值. 幸运的是,
在设计这个密码后,
图灵在密码学方面取得了更大的进步；他随后对Enigma消息的解密无疑挽救了数千人的生命,
如果不是整个英国.</p>
<h2 id="995_1">9.9.5 图灵后记</h2>
<p>战争结束几年后, 图灵的家被抢劫. 侦探很快确定,
图灵的一位前同性恋人密谋参与了抢劫. 因此, 他们逮捕了图灵——也就是说,
他们逮捕了艾伦·图灵——因为在当时的英国,
同性恋是一种可判处最多两年监禁的罪行. 图灵因同性恋被判处激素“治疗”:
他被注射雌激素. 他开始出现乳房发育.</p>
<p>三年后, 计算机科学的创始人艾伦·图灵去世了.
他的母亲在自己儿子的传记中解释了发生了什么事. 尽管她多次警告,
图灵在自己的家中进行化学实验. 显然, 她最担心的事情发生了:
图灵在吃苹果时用氰化钾自杀了.</p>
<h2 id="910">9.10 欧拉定理</h2>
<p>我们将在下一节讨论的 RSA 密码系统和其他当前用于编码秘密消息的方案,
涉及计算大幂次数除以模数的余数.
关于幂次余数的一个基本事实来自欧拉关于同余的定理.</p>
<div class="def">
<h4 id="9101">定义 9.10.1</h4>
<p>对于 <span class="arithmatex">\(n &gt; 0\)</span>, 定义</p>
<div class="arithmatex">\[
\phi(n) := 在 [0..n) 内与 n 互素的整数个数. 
\]</div>
<p>此函数 <span class="arithmatex">\(\phi\)</span> 称为欧拉 <span class="arithmatex">\(\phi\)</span> 函数.</p>
</div>
<p>例如, <span class="arithmatex">\(\phi(7) = 6\)</span>, 因为 [0..7) 内的所有6个正整数都与素数7互素.
只有0与7不互素. 此外, <span class="arithmatex">\(\phi(12) = 4\)</span>, 因为1、5、7和11是 [0..12)
内唯一与12互素的数.</p>
<p>更一般地, 如果 <span class="arithmatex">\(p\)</span> 是素数, 则 <span class="arithmatex">\(\phi(p) = p - 1\)</span>, 因为 [0..p)
内的每个正数都与 <span class="arithmatex">\(p\)</span> 互素. 但是当 <span class="arithmatex">\(n\)</span> 是合数时, <span class="arithmatex">\(\phi\)</span> 函数变得有点复杂.
我们将在下一节回到这个问题.</p>
<p>欧拉定理传统上以同余的形式表述:</p>
<div class="thm">
<h4 id="_8">定理（欧拉定理）</h4>
<p>如果 <span class="arithmatex">\(n\)</span> 和 <span class="arithmatex">\(k\)</span> 是互素的, 则</p>
<div class="arithmatex">\[
k^{\phi(n)} \equiv 1 \pmod{n}.  \quad (9.15)
\]</div>
</div>
<p>当我们用 <span class="arithmatex">\(Z_n\)</span> 中的术语重新表述欧拉定理时, 事情变得更简单.</p>
<div class="def">
<h4 id="9102">定义 9.10.2</h4>
<p>令 <span class="arithmatex">\(Z^*_n\)</span> 为 [0..n) 内与 <span class="arithmatex">\(n\)</span> 互素的整数集合:</p>
<div class="arithmatex">\[
Z^*_n := \{ k \in [0..n) \mid \text{gcd}(k, n) = 1 \}.  \quad (9.16)
\]</div>
</div>
<p>因此,</p>
<div class="arithmatex">\[
\phi(n) = |Z^*_n|. 
\]</div>
<div class="thm">
<h4 id="9103-z_n">定理 9.10.3 （<span class="arithmatex">\(Z_n\)</span> 中的欧拉定理）</h4>
<p>对于所有 <span class="arithmatex">\(k \in Z^*_n\)</span>,</p>
<div class="arithmatex">\[
k^{\phi(n)} = 1 \quad (Z_n).  \quad (9.17)
\]</div>
</div>
<p>定理 9.10.3 将从两个非常简单的引理得出. 首先让我们观察到 <span class="arithmatex">\(Z^*_n\)</span> 在
<span class="arithmatex">\(Z_n\)</span> 中在乘法下是封闭的:</p>
<div class="lem">
<h4 id="9104">引理 9.10.4</h4>
<p>如果 <span class="arithmatex">\(j, k \in Z^*_n\)</span>, 则 <span class="arithmatex">\(j \cdot_n k \in Z^*_n\)</span>.</p>
<p>证明的方法有很多种（见问题 9.69）.</p>
</div>
<div class="def">
<h4 id="9105">定义 9.10.5</h4>
<p>对于 <span class="arithmatex">\(Z_n\)</span> 中的任何元素 <span class="arithmatex">\(k\)</span> 和子集 <span class="arithmatex">\(S\)</span>, 令</p>
<div class="arithmatex">\[
kS := \{ k \cdot_n s \mid s \in S \}. 
\]</div>
</div>
<div class="lem">
<h4 id="9106">引理 9.10.6</h4>
<p>如果 <span class="arithmatex">\(k \in Z^*_n\)</span> 且 <span class="arithmatex">\(S \subseteq Z_n\)</span>, 则</p>
<div class="arithmatex">\[
|kS| = |S|. 
\]</div>
</div>
<div class="prf">
<p>由于 <span class="arithmatex">\(k \in Z^*_n\)</span>, 根据定理 9.9.5, 它是可消去的. 因此,</p>
<div class="arithmatex">\[
[k \cdot s = k \cdot t \quad (Z_n)] \implies s = t. 
\]</div>
</div>
<p>因此, 在 <span class="arithmatex">\(Z_n\)</span> 中乘以 <span class="arithmatex">\(k\)</span> 将 <span class="arithmatex">\(S\)</span> 的所有元素映射到 <span class="arithmatex">\(kS\)</span> 的不同元素,
这意味着 <span class="arithmatex">\(S\)</span> 和 <span class="arithmatex">\(kS\)</span> 是相同的大小.</p>
<div class="cor">
<h4 id="9107">推论 9.10.7</h4>
<p>如果 <span class="arithmatex">\(k \in Z^*_n\)</span>, 则</p>
<div class="arithmatex">\[
kZ^*_n = Z^*_n. 
\]</div>
</div>
<div class="prf">
<p>由于 <span class="arithmatex">\(Z^*_n\)</span> 中元素的乘积仍在 <span class="arithmatex">\(Z^*_n\)</span> 中, 根据引理 9.10.4. 所以如果
<span class="arithmatex">\(k \in Z^*_n\)</span>, 则 <span class="arithmatex">\(kZ^*_n \subseteq Z^*_n\)</span>. 但根据引理 9.10.6, <span class="arithmatex">\(kZ^*_n\)</span>
和 <span class="arithmatex">\(Z^*_n\)</span> 大小相同, 所以它们必须相等.</p>
</div>
<p>现在我们可以查看欧拉定理的完整证明了.</p>
<div class="prf">
<p>令</p>
<div class="arithmatex">\[
P := k_1 \cdot k_2 \cdot \cdots \cdot k_{\phi(n)} \quad (Z_n)
\]</div>
<p>为 <span class="arithmatex">\(Z^*_n\)</span> 中所有数在 <span class="arithmatex">\(Z_n\)</span> 中的乘积. 令</p>
<div class="arithmatex">\[
Q := (k \cdot k_1) \cdot (k \cdot k_2) \cdot \cdots \cdot (k \cdot k_{\phi(n)}) \quad (Z_n)
\]</div>
<p>对于某些 <span class="arithmatex">\(k \in Z^*_n\)</span>. 将 <span class="arithmatex">\(k\)</span> 提取出来立即得到</p>
<div class="arithmatex">\[
Q = k^{\phi(n)} P \quad (Z_n). 
\]</div>
<p>但是 <span class="arithmatex">\(Q\)</span> 与在 <span class="arithmatex">\(kZ^*_n\)</span> 中的数的乘积相同, 而 <span class="arithmatex">\(kZ^*_n = Z^*_n\)</span>,
因此我们意识到 <span class="arithmatex">\(Q\)</span> 是与 <span class="arithmatex">\(P\)</span> 相同的数的乘积, 只是顺序不同. 总之, 我们有</p>
<div class="arithmatex">\[
P = Q = k^{\phi(n)} P \quad (Z_n). 
\]</div>
<p>此外, 根据引理 9.10.4, <span class="arithmatex">\(P \in Z^*_n\)</span>, 因此可以从等式的两边消去, 得到</p>
<div class="arithmatex">\[
1 = k^{\phi(n)} \quad (Z_n). 
\]</div>
</div>
<p>欧拉定理提供了另一种方法来找到模 <span class="arithmatex">\(n\)</span> 的逆元: 如果 <span class="arithmatex">\(k\)</span> 与 <span class="arithmatex">\(n\)</span> 互素, 则
<span class="arithmatex">\(k^{\phi(n)-1}\)</span> 是 <span class="arithmatex">\(k\)</span> 的 <span class="arithmatex">\(Z_n\)</span> 逆元,
并且我们可以使用快速求幂高效地计算这个 <span class="arithmatex">\(k\)</span> 幂. 然而, 这种方法需要计算
<span class="arithmatex">\(\phi(n)\)</span>. 在下一节中, 我们将展示如果知道 <span class="arithmatex">\(n\)</span> 的素数因子分解, 计算
<span class="arithmatex">\(\phi(n)\)</span> 是容易的. 但我们知道, 找到 <span class="arithmatex">\(n\)</span> 的因子分解在 <span class="arithmatex">\(n\)</span>
很大时通常很难, 所以碎石机仍然是计算模 <span class="arithmatex">\(n\)</span> 逆元的最佳方法.</p>
<div class="cor">
<h4 id="9108">推论 9.10.8 （费马小定理）</h4>
<p>假设 <span class="arithmatex">\(p\)</span> 是一个素数, 且 <span class="arithmatex">\(k\)</span> 不是 <span class="arithmatex">\(p\)</span> 的倍数, 则</p>
<div class="arithmatex">\[
k^{p-1} \equiv 1 \pmod{p}. 
\]</div>
</div>
<h2 id="9101-phi">9.10.1 计算欧拉 <span class="arithmatex">\(\phi\)</span> 函数</h2>
<p>RSA 使用模两个大素数乘积的算术运算, 因此我们从一个基本解释开始,
解释如何计算素数 <span class="arithmatex">\(p\)</span> 和 <span class="arithmatex">\(q\)</span> 的乘积 <span class="arithmatex">\(\phi(pq)\)</span>:</p>
<div class="lem">
<h4 id="9109">引理 9.10.9</h4>
<p>对于素数 <span class="arithmatex">\(p \neq q\)</span>,</p>
<div class="arithmatex">\[
\phi(pq) = (p-1)(q-1). 
\]</div>
</div>
<div class="prf">
<p>由于 <span class="arithmatex">\(p\)</span> 和 <span class="arithmatex">\(q\)</span> 是素数, 任何与 <span class="arithmatex">\(pq\)</span> 不互素的数必须是 <span class="arithmatex">\(p\)</span> 的倍数或 <span class="arithmatex">\(q\)</span>
的倍数. 在 [0..pq) 内的 <span class="arithmatex">\(pq\)</span> 个数中, 有 <span class="arithmatex">\(p\)</span> 个是 <span class="arithmatex">\(p\)</span> 的倍数, 有 <span class="arithmatex">\(q\)</span>
个是 <span class="arithmatex">\(q\)</span> 的倍数. 由于 <span class="arithmatex">\(p\)</span> 和 <span class="arithmatex">\(q\)</span> 互素, 唯一同时是 <span class="arithmatex">\(p\)</span> 和 <span class="arithmatex">\(q\)</span>
的倍数的数是 0. 因此, 在 [0..pq) 内, 有 <span class="arithmatex">\(p + q - 1\)</span> 个数不是 <span class="arithmatex">\(n\)</span>
的倍数. 这意味着</p>
<div class="arithmatex">\[
\phi(pq) = pq - (p + q - 1) \\
= (p-1)(q-1), 
\]</div>
<p>如所述.</p>
</div>
<p>以下定理提供了一种计算任意 <span class="arithmatex">\(n\)</span> 的 <span class="arithmatex">\(\phi(n)\)</span> 的方法:</p>
<div class="thm">
<h4 id="91010">定理 9.10.10</h4>
<ol>
<li>如果 <span class="arithmatex">\(p\)</span> 是素数, 则 <span class="arithmatex">\(\phi(p^k) = p^k - p^{k-1}\)</span> 对于 <span class="arithmatex">\(k \geq 1\)</span>.</li>
<li>如果 <span class="arithmatex">\(a\)</span> 和 <span class="arithmatex">\(b\)</span> 是互素的, 则 <span class="arithmatex">\(\phi(ab) = \phi(a) \phi(b)\)</span>.</li>
</ol>
</div>
<p>这是使用定理 9.10.10 计算 <span class="arithmatex">\(\phi(300)\)</span> 的 一个例子:</p>
<div class="arithmatex">\[
\begin{align}
&amp;\phi(300) = \phi(2^2 \cdot 3 \cdot 5^2) \\
&amp;= \phi(2^2) \cdot \phi(3) \cdot \phi(5^2) \quad &amp;(\text{by Theorem 9.10.10.(b)}) \\
&amp;= (2^2 - 2^1)(3^1 - 3^0)(5^2 - 5^1) \quad &amp;(\text{by Theorem 9.10.10.(a)}) \\
&amp;= (4 - 2)(3 - 1)(25 - 5) \\
&amp;= 2 \cdot 2 \cdot 20 \\
&amp;= 80. 
\end{align}
\]</div>
<p>注意, 引理 9.10.9 也是定理 9.10.10.(b) 的一个特例,
因为我们知道对于任何素数 <span class="arithmatex">\(p\)</span>, <span class="arithmatex">\(\phi(p) = p - 1\)</span>.</p>
<div class="cor">
<h4 id="91011">推论 9.10.11</h4>
<p>对于任意数 <span class="arithmatex">\(n\)</span>, 如果 <span class="arithmatex">\(p_1, p_2, \ldots, p_j\)</span> 是 <span class="arithmatex">\(n\)</span> 的不同素数因子, 则</p>
<div class="arithmatex">\[
\phi(n) = n \left(1 - \frac{1}{p_1}\right) \left(1 - \frac{1}{p_2}\right) \cdots \left(1 - \frac{1}{p_j}\right). 
\]</div>
</div>
<p>我们将在15.9.5节中根据计数规则给出推论9.10.11的另一个证明.</p>
<h2 id="911-rsa">9.11 RSA 公钥加密</h2>
<p>图灵的密码没有如他所希望的那样工作. 然而,
他使用数论作为密码学基础的基本思想在他去世后几十年里取得了辉煌的成功.</p>
<p>1977年, Ronald Rivest、Adi Shamir 和 Leonard Adleman
在麻省理工学院提出了一种高度安全的密码系统, 称为 RSA, 基于数论. RSA
方案的目的是通过公共通信渠道传输秘密消息. 与图灵的密码一样,
传输的消息是固定大小的非负整数.</p>
<p>此外, RSA 相较于传统密码有一个主要优势:
加密消息的发送者和接收者不需要事先同意一个秘密密钥. 相反,
接收者有一个私钥, 他们严密保护该私钥, 还有一个他们尽可能广泛分发的公钥.
希望向接收者传送秘密消息的发送者使用接收者广泛分发的公钥加密他们的消息.
接收者然后可以使用他们严密保护的私钥解密接收到的消息.
公钥密码系统的使用允许你和亚马逊, 例如, 在安全交易中进行加密,
而无需事先在黑暗小巷里交换密钥.</p>
<p>有趣的是, RSA 并不在模素数下运作, 如图灵假设的版本2.0,
而是在两个大素数的乘积下运作——通常是数百位长的素数. 此外, RSA
不是通过与密钥相乘来加密, 而是通过对密钥进行幂运算,
这就是为什么欧拉定理对于理解RSA至关重要.</p>
<p>RSA 公钥加密方案见下框.</p>
<h3 id="rsa">RSA 加密系统</h3>
<p>一个希望能够接收秘密数字消息的接收者创建一个他们保密的私钥和一个他们公开的公钥.
任何拥有公钥的人都可以成为发送者,
他们可以公开向接收者发送秘密消息——即使他们从未共享过除公钥以外的任何信息.</p>
<p>他们的做法如下:</p>
<h4 id="_9">预先准备</h4>
<p>接收者创建一个公钥和一个私钥, 如下所示. 1. 生成两个不同的素数 <span class="arithmatex">\(p\)</span> 和
<span class="arithmatex">\(q\)</span>. 这些用于生成私钥, 必须保密. （在当前实践中, <span class="arithmatex">\(p\)</span> 和 <span class="arithmatex">\(q\)</span>
选择为数百位长的数字. ） 2. 令 <span class="arithmatex">\(n := pq\)</span>. 3. 选择一个整数
<span class="arithmatex">\(e \in [0..n)\)</span>, 使得 <span class="arithmatex">\(\text{gcd}(e, (p-1)(q-1)) = 1\)</span>. 公钥是对 <span class="arithmatex">\((e, n)\)</span>.
这应该广泛分发. 4. 令私钥 <span class="arithmatex">\(d \in [0..n)\)</span> 为环 <span class="arithmatex">\(Z_{(p-1)(q-1)}\)</span> 中 <span class="arithmatex">\(e\)</span>
的逆元. 可以使用碎石机找到这个私钥. 私钥 <span class="arithmatex">\(d\)</span> 应该保密！</p>
<h4 id="_10">编码</h4>
<p>要传送消息 <span class="arithmatex">\(m \in [0..n)\)</span> 给接收者, 发送者使用公钥加密消息 <span class="arithmatex">\(m\)</span>
成一个数字消息</p>
<div class="arithmatex">\[
\hat{m} := m^e \quad (Z_n). 
\]</div>
<p>发送者然后可以公开传送 <span class="arithmatex">\(\hat{m}\)</span> 给接收者.</p>
<h4 id="_11">解码</h4>
<p>接收者使用私钥解密消息 <span class="arithmatex">\(\hat{m}\)</span> 回到消息 <span class="arithmatex">\(m\)</span>:</p>
<div class="arithmatex">\[
m = \hat{m}^d \quad (Z_n). 
\]</div>
<p>为什么 RSA 被认为是安全的？如果你知道 <span class="arithmatex">\(p\)</span> 和 <span class="arithmatex">\(q\)</span>,
你可以通过使用碎石机轻松计算出私钥 <span class="arithmatex">\(d\)</span>.
但假设将一个由数百位素数组成的乘积 <span class="arithmatex">\(n\)</span> 因式分解是极其困难的,
那么努力因式分解 <span class="arithmatex">\(n\)</span> 将不会破坏 RSA.</p>
<p>是否有另一种方法从公钥反向工程私钥 <span class="arithmatex">\(d\)</span> 而不涉及因式分解 <span class="arithmatex">\(n\)</span>？实际上没有.
事实证明, 仅给定私钥和公钥, 很容易因式分解 <span class="arithmatex">\(n\)</span>（对此的证明在问题 9.86
中略述）. 因此, 如果我们有信心因式分解极其困难,
那么我们也可以同样有信心仅从公钥找到私钥将毫无希望.</p>
<p>即使我们相信不会找到 RSA 私钥, 这也不能排除通过绕过私钥的方式解码 RSA
消息的可能性. 这是密码学中的一个重要未证明的猜想, 即破解 RSA
的任何方式——不仅仅是找到密钥——都意味着能够因式分解. 这将是对 RSA
安全性比目前已知的更强的理论保证.</p>
<p>但真正的信心来自于 RSA
几乎四十年来经受住了世界上最复杂的密码学家的所有攻击.
尽管几十年来这些攻击不断, 没有发现重大漏洞.
这就是为什么数学、金融和情报界都在赌 RSA 加密的安全性.</p>
<p>你可以希望通过更多地研究数论, 你将成为第一个弄清楚如何快速因式分解的人,
进而破坏 RSA. 但也有警告, 即使是高斯也在因式分解方面工作了多年,
却没有很多成效——如果你真的搞明白了,
可能会在安全部门的负责人面前与一些缺乏幽默感的家伙共度时光.</p>
<h2 id="912-sat">9.12 SAT 与此有何关系？</h2>
<p>那么, 如果存在一个高效的可满足性（SAT）测试,
社会——或者至少是每个人的秘密代码——为什么会崩溃呢？正如我们在第 3.5
节中所说的那样. 为了解释这一点, 请记住, RSA 可以在计算上管理,
因为两个素数的乘法是快速的, 但分解两个素数的乘积似乎极其困难.</p>
<p>让我们从第 3.2 节的观察开始, 即数字电路可以通过一堆命题公式来描述,
其总规模与电路的规模大致相同. 因此, 测试电路的可满足性相当于该电路的 SAT
问题（参见问题 3.22）.</p>
<p>现在设计数字乘法电路是完全常规的. 我们可以轻松地用 AND、OR 和 NOT 门以及
1 个输出线和 <span class="arithmatex">\(4n\)</span> 个数字输入线来构建一个数字“乘积检查器”电路. 前 <span class="arithmatex">\(n\)</span>
个输入用于整数 <span class="arithmatex">\(i\)</span> 的二进制表示, 接下来的 <span class="arithmatex">\(n\)</span> 个输入用于整数 <span class="arithmatex">\(j\)</span>
的二进制表示, 剩下的 <span class="arithmatex">\(2n\)</span> 个输入用于整数 <span class="arithmatex">\(k\)</span> 的二进制表示. 电路的输出为
1 当且仅当 <span class="arithmatex">\(ij = k\)</span> 且 <span class="arithmatex">\(i, j &gt; 1\)</span>. 这种乘积检查器的直观设计使用的门数与
<span class="arithmatex">\(n^2\)</span> 成正比.</p>
<p>现在, 这里是如何使用 SAT 求解器分解任何长度为 <span class="arithmatex">\(2n\)</span>
的二进制表示的数的方法. 首先, 固定最后的 2n 个数字输入——用于 <span class="arithmatex">\(k\)</span>
的二进制表示——使得 <span class="arithmatex">\(k = m\)</span>.</p>
<p>接下来, 将表示 <span class="arithmatex">\(i\)</span> 的第一个 <span class="arithmatex">\(n\)</span> 数字输入设为 1. 进行 SAT 测试,
查看是否存在一个满足 <span class="arithmatex">\(i\)</span> 和 <span class="arithmatex">\(j\)</span> 表示的其余 <span class="arithmatex">\(2n - 1\)</span> 个输入值的赋值.
也就是说, 查看 <span class="arithmatex">\(i\)</span> 和 <span class="arithmatex">\(j\)</span> 的剩余输入是否可以被填充以使电路输出 1.
如果存在这样的赋值, 则将第一个 <span class="arithmatex">\(i\)</span>-输入固定为 1, 否则将其固定为 0.
现在我们已将第一个 <span class="arithmatex">\(i\)</span>-输入设置为满足 <span class="arithmatex">\(ij = m\)</span> 的某个 <span class="arithmatex">\(i\)</span>
的二进制表示的第一个数字.</p>
<p>现在对 <span class="arithmatex">\(i\)</span> 的表示的第二个 <span class="arithmatex">\(n\)</span> 输入执行相同操作, 然后第三个, 依此类推,
通过所有的 <span class="arithmatex">\(n\)</span> 输入为数字 1. 此时, 我们有 <span class="arithmatex">\(i &gt; 1\)</span> 的完整 n 位二进制表示,
其 <span class="arithmatex">\(ij = m\)</span> 对于某个 <span class="arithmatex">\(j &gt; 1\)</span> 成立. 换句话说, 我们找到一个整数 <span class="arithmatex">\(i\)</span>, 它是
<span class="arithmatex">\(m\)</span> 的因数. 现在我们可以通过将 <span class="arithmatex">\(m\)</span> 除以 <span class="arithmatex">\(i\)</span> 来找到 <span class="arithmatex">\(j\)</span>.</p>
<p>因此, 在进行 <span class="arithmatex">\(n\)</span> 次 SAT 测试后, 我们已经分解了 <span class="arithmatex">\(m\)</span>. 这意味着,
如果可以通过一个步骤数上界为 <span class="arithmatex">\(n\)</span> 次, 确定具有 <span class="arithmatex">\(4n\)</span> 个输入和大约 <span class="arithmatex">\(n^2\)</span>
个门的数字电路的 SAT, 步骤数由一个 <span class="arithmatex">\(n\)</span> 的多项式的 <span class="arithmatex">\(d\)</span> 次幂界定,
那么长度为 <span class="arithmatex">\(2n\)</span> 的数字可以在 <span class="arithmatex">\(n\)</span> 次这个多项式的步骤数内分解. 也就是说,
步骤数由一个 <span class="arithmatex">\(n\)</span> 的 <span class="arithmatex">\(d + 1\)</span> 次幂的多项式界定. 所以如果 SAT
可以在多项式时间内解决, 那么分解也是如此, 因而 RSA 将很“容易”被破解.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["toc.integrate", "navigation.sections", "navigation.tabs", "navigation.sections", "navigation.top", "navigation.tracking", "search.suggest", "search.highlight", "contents.tabs.link", "contents.code.annotation", "contents.code.copy", "toc.follow"], "search": "../../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.471ce7a9.min.js"></script>
      
        <script src="../../../javascripts/solfold.js"></script>
      
        <script src="../../../javascripts/config.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>