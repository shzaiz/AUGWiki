
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../5-ind/">
      
      
        <link rel="next" href="../7-rdt/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.32">
    
    
      
        <title>6 状态机 - AUG's Lecture Notes</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.3cba04c6.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      
  
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
  
  <style>:root{--md-admonition-icon--note:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M1 7.775V2.75C1 1.784 1.784 1 2.75 1h5.025c.464 0 .91.184 1.238.513l6.25 6.25a1.75 1.75 0 0 1 0 2.474l-5.026 5.026a1.75 1.75 0 0 1-2.474 0l-6.25-6.25A1.752 1.752 0 0 1 1 7.775Zm1.5 0c0 .066.026.13.073.177l6.25 6.25a.25.25 0 0 0 .354 0l5.025-5.025a.25.25 0 0 0 0-.354l-6.25-6.25a.25.25 0 0 0-.177-.073H2.75a.25.25 0 0 0-.25.25ZM6 5a1 1 0 1 1 0 2 1 1 0 0 1 0-2Z"/></svg>');--md-admonition-icon--abstract:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M2.5 1.75v11.5c0 .138.112.25.25.25h3.17a.75.75 0 0 1 0 1.5H2.75A1.75 1.75 0 0 1 1 13.25V1.75C1 .784 1.784 0 2.75 0h8.5C12.216 0 13 .784 13 1.75v7.736a.75.75 0 0 1-1.5 0V1.75a.25.25 0 0 0-.25-.25h-8.5a.25.25 0 0 0-.25.25Zm13.274 9.537v-.001l-4.557 4.45a.75.75 0 0 1-1.055-.008l-1.943-1.95a.75.75 0 0 1 1.062-1.058l1.419 1.425 4.026-3.932a.75.75 0 1 1 1.048 1.074ZM4.75 4h4.5a.75.75 0 0 1 0 1.5h-4.5a.75.75 0 0 1 0-1.5ZM4 7.75A.75.75 0 0 1 4.75 7h2a.75.75 0 0 1 0 1.5h-2A.75.75 0 0 1 4 7.75Z"/></svg>');--md-admonition-icon--definition:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8Zm8-6.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13ZM6.5 7.75A.75.75 0 0 1 7.25 7h1a.75.75 0 0 1 .75.75v2.75h.25a.75.75 0 0 1 0 1.5h-2a.75.75 0 0 1 0-1.5h.25v-2h-.25a.75.75 0 0 1-.75-.75ZM8 6a1 1 0 1 1 0-2 1 1 0 0 1 0 2Z"/></svg>');--md-admonition-icon--tip:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M3.499.75a.75.75 0 0 1 1.5 0v.996C5.9 2.903 6.793 3.65 7.662 4.376l.24.202c-.036-.694.055-1.422.426-2.163C9.1.873 10.794-.045 12.622.26 14.408.558 16 1.94 16 4.25c0 1.278-.954 2.575-2.44 2.734l.146.508.065.22c.203.701.412 1.455.476 2.226.142 1.707-.4 3.03-1.487 3.898C11.714 14.671 10.27 15 8.75 15h-6a.75.75 0 0 1 0-1.5h1.376a4.484 4.484 0 0 1-.563-1.191 3.835 3.835 0 0 1-.05-2.063 4.647 4.647 0 0 1-2.025-.293.75.75 0 0 1 .525-1.406c1.357.507 2.376-.006 2.698-.318l.009-.01a.747.747 0 0 1 1.06 0 .748.748 0 0 1-.012 1.074c-.912.92-.992 1.835-.768 2.586.221.74.745 1.337 1.196 1.621H8.75c1.343 0 2.398-.296 3.074-.836.635-.507 1.036-1.31.928-2.602-.05-.603-.216-1.224-.422-1.93l-.064-.221c-.12-.407-.246-.84-.353-1.29a2.425 2.425 0 0 1-.507-.441 3.075 3.075 0 0 1-.633-1.248.75.75 0 0 1 1.455-.364c.046.185.144.436.31.627.146.168.353.305.712.305.738 0 1.25-.615 1.25-1.25 0-1.47-.95-2.315-2.123-2.51-1.172-.196-2.227.387-2.706 1.345-.46.92-.27 1.774.019 3.062l.042.19a.884.884 0 0 1 .01.05c.348.443.666.949.94 1.553a.75.75 0 1 1-1.365.62c-.553-1.217-1.32-1.94-2.3-2.768L6.7 5.527c-.814-.68-1.75-1.462-2.692-2.619a3.737 3.737 0 0 0-1.023.88c-.406.495-.663 1.036-.722 1.508.116.122.306.21.591.239.388.038.797-.06 1.032-.19a.75.75 0 0 1 .728 1.31c-.515.287-1.23.439-1.906.373-.682-.067-1.473-.38-1.879-1.193L.75 5.677V5.5c0-.984.48-1.94 1.077-2.664.46-.559 1.05-1.055 1.673-1.353V.75Z"/></svg>');--md-admonition-icon--success:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"/></svg>');--md-admonition-icon--question:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8Zm8-6.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13ZM6.92 6.085h.001a.749.749 0 1 1-1.342-.67c.169-.339.436-.701.849-.977C6.845 4.16 7.369 4 8 4a2.756 2.756 0 0 1 1.637.525c.503.377.863.965.863 1.725 0 .448-.115.83-.329 1.15-.205.307-.47.513-.692.662-.109.072-.22.138-.313.195l-.006.004a6.24 6.24 0 0 0-.26.16.952.952 0 0 0-.276.245.75.75 0 0 1-1.248-.832c.184-.264.42-.489.692-.661.103-.067.207-.132.313-.195l.007-.004c.1-.061.182-.11.258-.161a.969.969 0 0 0 .277-.245C8.96 6.514 9 6.427 9 6.25a.612.612 0 0 0-.262-.525A1.27 1.27 0 0 0 8 5.5c-.369 0-.595.09-.74.187a1.01 1.01 0 0 0-.34.398ZM9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"/></svg>');--md-admonition-icon--warning:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M6.457 1.047c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0 1 14.082 15H1.918a1.75 1.75 0 0 1-1.543-2.575Zm1.763.707a.25.25 0 0 0-.44 0L1.698 13.132a.25.25 0 0 0 .22.368h12.164a.25.25 0 0 0 .22-.368Zm.53 3.996v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0ZM9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"/></svg>');--md-admonition-icon--failure:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M2.344 2.343h-.001a8 8 0 0 1 11.314 11.314A8.002 8.002 0 0 1 .234 10.089a8 8 0 0 1 2.11-7.746Zm1.06 10.253a6.5 6.5 0 1 0 9.108-9.275 6.5 6.5 0 0 0-9.108 9.275ZM6.03 4.97 8 6.94l1.97-1.97a.749.749 0 0 1 1.275.326.749.749 0 0 1-.215.734L9.06 8l1.97 1.97a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215L8 9.06l-1.97 1.97a.749.749 0 0 1-1.275-.326.749.749 0 0 1 .215-.734L6.94 8 4.97 6.03a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018Z"/></svg>');--md-admonition-icon--danger:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M9.504.43a1.516 1.516 0 0 1 2.437 1.713L10.415 5.5h2.123c1.57 0 2.346 1.909 1.22 3.004l-7.34 7.142a1.249 1.249 0 0 1-.871.354h-.302a1.25 1.25 0 0 1-1.157-1.723L5.633 10.5H3.462c-1.57 0-2.346-1.909-1.22-3.004L9.503.429Zm1.047 1.074L3.286 8.571A.25.25 0 0 0 3.462 9H6.75a.75.75 0 0 1 .694 1.034l-1.713 4.188 6.982-6.793A.25.25 0 0 0 12.538 7H9.25a.75.75 0 0 1-.683-1.06l2.008-4.418.003-.006a.036.036 0 0 0-.004-.009l-.006-.006-.008-.001c-.003 0-.006.002-.009.004Z"/></svg>');--md-admonition-icon--bug:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M4.72.22a.75.75 0 0 1 1.06 0l1 .999a3.488 3.488 0 0 1 2.441 0l.999-1a.748.748 0 0 1 1.265.332.75.75 0 0 1-.205.729l-.775.776c.616.63.995 1.493.995 2.444v.327c0 .1-.009.197-.025.292.408.14.764.392 1.029.722l1.968-.787a.75.75 0 0 1 .556 1.392L13 7.258V9h2.25a.75.75 0 0 1 0 1.5H13v.5c0 .409-.049.806-.141 1.186l2.17.868a.75.75 0 0 1-.557 1.392l-2.184-.873A4.997 4.997 0 0 1 8 16a4.997 4.997 0 0 1-4.288-2.427l-2.183.873a.75.75 0 0 1-.558-1.392l2.17-.868A5.036 5.036 0 0 1 3 11v-.5H.75a.75.75 0 0 1 0-1.5H3V7.258L.971 6.446a.75.75 0 0 1 .558-1.392l1.967.787c.265-.33.62-.583 1.03-.722a1.677 1.677 0 0 1-.026-.292V4.5c0-.951.38-1.814.995-2.444L4.72 1.28a.75.75 0 0 1 0-1.06Zm.53 6.28a.75.75 0 0 0-.75.75V11a3.5 3.5 0 1 0 7 0V7.25a.75.75 0 0 0-.75-.75ZM6.173 5h3.654A.172.172 0 0 0 10 4.827V4.5a2 2 0 1 0-4 0v.327c0 .096.077.173.173.173Z"/></svg>');--md-admonition-icon--example:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M5 5.782V2.5h-.25a.75.75 0 0 1 0-1.5h6.5a.75.75 0 0 1 0 1.5H11v3.282l3.666 5.76C15.619 13.04 14.543 15 12.767 15H3.233c-1.776 0-2.852-1.96-1.899-3.458Zm-2.4 6.565a.75.75 0 0 0 .633 1.153h9.534a.75.75 0 0 0 .633-1.153L12.225 10.5h-8.45ZM9.5 2.5h-3V6c0 .143-.04.283-.117.403L4.73 9h6.54L9.617 6.403A.746.746 0 0 1 9.5 6Z"/></svg>');--md-admonition-icon--quote:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M1.75 2.5h10.5a.75.75 0 0 1 0 1.5H1.75a.75.75 0 0 1 0-1.5Zm4 5h8.5a.75.75 0 0 1 0 1.5h-8.5a.75.75 0 0 1 0-1.5Zm0 5h8.5a.75.75 0 0 1 0 1.5h-8.5a.75.75 0 0 1 0-1.5ZM2.5 7.75v6a.75.75 0 0 1-1.5 0v-6a.75.75 0 0 1 1.5 0Z"/></svg>');}</style>



    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/katex.min.css">
    
      <link rel="stylesheet" href="../../../css/latex.css">
    
      <link rel="stylesheet" href="../../../css/thm.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="deep-purple" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#6" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="AUG&#39;s Lecture Notes" class="md-header__button md-logo" aria-label="AUG's Lecture Notes" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            AUG's Lecture Notes
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              6 状态机
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
    
  
  主页

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../univ-intro/" class="md-tabs__link">
          
  
  高中大学衔接

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../volunteer/" class="md-tabs__link">
          
  
  公益实践活动

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../introi/" class="md-tabs__link">
          
  
  信息竞赛从入门到放弃

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../" class="md-tabs__link">
          
  
  附录

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="AUG&#39;s Lecture Notes" class="md-nav__button md-logo" aria-label="AUG's Lecture Notes" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    AUG's Lecture Notes
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    主页
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    高中大学衔接
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            高中大学衔接
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../univ-intro/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    高中与大学衔接: 计算机系简介
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../univ-intro/1-intro-all/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1. 认识计算机
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../univ-intro/hw1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    练习题1: 使用搜索引擎
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../univ-intro/lab1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    实验 1: 在 U 盘上安装 Linux
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    公益实践活动
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            公益实践活动
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../volunteer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    “七彩假期”社区科技教育志愿者服务
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../volunteer/1-comp-intro/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1. 认识计算机
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../volunteer/binary/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2. 认识二进制
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../volunteer/lec3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3. 程序的逻辑
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    信息竞赛从入门到放弃
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            信息竞赛从入门到放弃
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../introi/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OI:从入门到放弃 (2024夏季学期)
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  <span class="md-ellipsis">
    附录
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            附录
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    附录
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2" checked>
        
          
          <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    计算机科学中的数学
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            计算机科学中的数学
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    介绍:《计算机科学中的数学》
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2_2" checked>
        
          
          <label class="md-nav__link" for="__nav_5_2_2" id="__nav_5_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    正文
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_2_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5_2_2">
            <span class="md-nav__icon md-icon"></span>
            正文
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../2-wop/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2 良序原理
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../3-lf/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3 逻辑公式
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../4-mdt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4 数学中的”数据类型”
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../5-ind/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5 数学归纳法
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    6 状态机
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    6 状态机
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#61" class="md-nav__link">
    <span class="md-ellipsis">
      6.1 状态和转换
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#62" class="md-nav__link">
    <span class="md-ellipsis">
      6.2 不变性原理
    </span>
  </a>
  
    <nav class="md-nav" aria-label="6.2 不变性原理">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#621" class="md-nav__link">
    <span class="md-ellipsis">
      6.2.1 斜向移动的机器人
    </span>
  </a>
  
    <nav class="md-nav" aria-label="6.2.1 斜向移动的机器人">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#621_1" class="md-nav__link">
    <span class="md-ellipsis">
      引理 6.2.1
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#622" class="md-nav__link">
    <span class="md-ellipsis">
      定理 6.2.2
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#623" class="md-nav__link">
    <span class="md-ellipsis">
      推论 6.2.3
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#622_1" class="md-nav__link">
    <span class="md-ellipsis">
      6.2.2 不变性原理的陈述
    </span>
  </a>
  
    <nav class="md-nav" aria-label="6.2.2 不变性原理的陈述">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#624" class="md-nav__link">
    <span class="md-ellipsis">
      定义 6.2.4
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#625" class="md-nav__link">
    <span class="md-ellipsis">
      定义 6.2.5
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      不变性原理
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#623_1" class="md-nav__link">
    <span class="md-ellipsis">
      6.2.3 《虎胆龙威》示例
    </span>
  </a>
  
    <nav class="md-nav" aria-label="6.2.3 《虎胆龙威》示例">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#3" class="md-nav__link">
    <span class="md-ellipsis">
      《虎胆龙威3》状态机
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      永远的《虎胆龙威》
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#63" class="md-nav__link">
    <span class="md-ellipsis">
      6.3 部分正确性和终止性
    </span>
  </a>
  
    <nav class="md-nav" aria-label="6.3 部分正确性和终止性">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#631" class="md-nav__link">
    <span class="md-ellipsis">
      6.3.1 快速幂
    </span>
  </a>
  
    <nav class="md-nav" aria-label="6.3.1 快速幂">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      快速幂程序
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#632" class="md-nav__link">
    <span class="md-ellipsis">
      6.3.2 导出变量
    </span>
  </a>
  
    <nav class="md-nav" aria-label="6.3.2 导出变量">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#631_1" class="md-nav__link">
    <span class="md-ellipsis">
      定义 6.3.1
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#632_1" class="md-nav__link">
    <span class="md-ellipsis">
      定理 6.3.2
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#633" class="md-nav__link">
    <span class="md-ellipsis">
      6.3.3 使用良序集的终止性（可选）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#634" class="md-nav__link">
    <span class="md-ellipsis">
      6.3.4 向东南跳跃的机器人（可选）
    </span>
  </a>
  
    <nav class="md-nav" aria-label="6.3.4 向东南跳跃的机器人（可选）">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#634_1" class="md-nav__link">
    <span class="md-ellipsis">
      命题 6.3.4
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#64" class="md-nav__link">
    <span class="md-ellipsis">
      6.4 稳定婚姻问题
    </span>
  </a>
  
    <nav class="md-nav" aria-label="6.4 稳定婚姻问题">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#641" class="md-nav__link">
    <span class="md-ellipsis">
      定义 6.4.1
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#641_1" class="md-nav__link">
    <span class="md-ellipsis">
      6.4.1 求偶仪式
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#642" class="md-nav__link">
    <span class="md-ellipsis">
      6.4.2 婚礼日
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#643" class="md-nav__link">
    <span class="md-ellipsis">
      6.4.3 他们从此幸福地生活下去…
    </span>
  </a>
  
    <nav class="md-nav" aria-label="6.4.3 他们从此幸福地生活下去…">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#642_1" class="md-nav__link">
    <span class="md-ellipsis">
      引理 6.4.2
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#643_1" class="md-nav__link">
    <span class="md-ellipsis">
      定理 6.4.3
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#644" class="md-nav__link">
    <span class="md-ellipsis">
      定理 6.4.4
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#644_1" class="md-nav__link">
    <span class="md-ellipsis">
      6.4.4 …特别是男人
    </span>
  </a>
  
    <nav class="md-nav" aria-label="6.4.4 …特别是男人">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#645" class="md-nav__link">
    <span class="md-ellipsis">
      定义 6.4.5
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#646" class="md-nav__link">
    <span class="md-ellipsis">
      定义 6.4.6
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#647" class="md-nav__link">
    <span class="md-ellipsis">
      引理 6.4.7
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#648" class="md-nav__link">
    <span class="md-ellipsis">
      定义 6.4.8
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#649" class="md-nav__link">
    <span class="md-ellipsis">
      定理 6.4.9
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6411" class="md-nav__link">
    <span class="md-ellipsis">
      推论 6.4.11
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#645_1" class="md-nav__link">
    <span class="md-ellipsis">
      6.4.5 应用
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../7-rdt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7 递归的数据类型
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../8-infset/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    8 无穷集合
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../9-divis/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    9 整除性
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../10-gra-part/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    10. 有向图和偏序关系
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../11-cnet/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    11.通信网络
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../12-simpl-gra/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    12. 简单图
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_3" >
        
          
          <label class="md-nav__link" for="__nav_5_3" id="__nav_5_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    算法
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_3">
            <span class="md-nav__icon md-icon"></span>
            算法
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../algo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    介绍:《算法》by Jeff. E.
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_4" >
        
          
          <label class="md-nav__link" for="__nav_5_4" id="__nav_5_4_label" tabindex="">
            
  
  <span class="md-ellipsis">
    (初)高中数学甲种课本
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_4">
            <span class="md-nav__icon md-icon"></span>
            (初)高中数学甲种课本
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../hsmath/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    介绍:中学数学实验教材
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="6">6 状态机</h1>
<p>状态机是为逐步的过程建立的一种简单抽象模型. 由于在理解计算机程序的时候,
可以拆成一步一步的计算过程,
因此状态机在计算机科学中经常出现也就不足为奇了.
它们还出现在许多其他场景中, 例如设计数字电路和建模概率过程. 本节介绍
Floyd 的不变性原理, 这是一种证明状态机属性的”归纳法”.</p>
<p>在计算机科学中,
归纳法最重要的用途之一是证明一个或多个期望的属性在过程的每一步都保持成立.
通过一系列操作或步骤保持的属性称为保持不变性.</p>
<p>期望的不变量的例子包括变量从不超过某个值、到飞机的高度从未低于 1000
英尺, 或者核反应堆的温度从未超过熔毁的临界值.</p>
<h2 id="61">6.1 状态和转换</h2>
<p>形式上, 状态机只不过是集合上的二元关系, 只不过集合的元素被称为“状态”,
关系被称为转换关系, 转换关系图中的箭头被称为转换. 从状态 <span class="arithmatex">\(q\)</span> 到状态 <span class="arithmatex">\(r\)</span>
的转换将写成 <span class="arithmatex">\(q \rightarrow r\)</span>. 转换关系也被称为机器的状态图.
状态机还配备了一个指定的初始状态.</p>
<p><img alt="" src="../images/clipboard-1751244297.png" /></p>
<p>一个简单的例子是有界计数器, 它从 0 计数到 99 并溢出到 100. 该状态机如图
6.1 所示, 状态用圆圈表示, 转换用箭头表示, 初始状态 0 用双圆表示.
准确地说, 图示告诉我们这个有界计数器有以下状态：</p>
<div class="arithmatex">\[
\begin{aligned}
 \text { states }&amp;::=\{0,1, \ldots, 99, \text { overflow }\}, \\
 \text { start state }&amp;::= 0, \\
 \text { transitions }&amp;::=\{n \longrightarrow n+1 \mid 0 \leq n&lt;99\}  \cup\{99 \longrightarrow \text { overflow, overflow } \longrightarrow \text { overflow }\} .
\end{aligned}
\]</div>
<p>一旦溢出, 这台机器就没什么用了, 因为它没有办法从溢出状态中退出.</p>
<p>数字电路和字符串模式匹配算法的状态机通常只有有限数量的状态.
而模型连续计算的机器通常有无限数量的状态. 例如, 代替 99 有界计数器,
我们可以轻松定义一个“无界”计数器, 它在不溢出的情况下继续计数.
无界计数器具有无限状态集, 即非负整数, 使其状态图更难绘制.</p>
<p>状态机通常在状态和/或转换上定义标签,
以指示诸如输入或输出值、成本、容量或概率等内容.
我们的状态机不包含任何此类标签, 因为我们不需要它们. 我们将状态命名, 如图
6.1 所示, 因此我们可以讨论它们, 但名称不是状态机的一部分.</p>
<h2 id="62">6.2 不变性原理</h2>
<h3 id="621">6.2.1 斜向移动的机器人</h3>
<p>假设我们有一个机器人从原点开始, 在无限二维整数网格上移动.
机器人的状态在任何时候都可以通过机器人当前位置的整数坐标 <span class="arithmatex">\((x, y)\)</span>
来指定. 因此, 初始状态是 <span class="arithmatex">\((0, 0)\)</span>. 在每一步,
机器人可以移动到对角相邻的网格点, 如图 6.2 所示.</p>
<p><img alt="" src="../images/clipboard-2197951549.png" /></p>
<p>具体来说, 机器人的状态转移是：</p>
<div class="arithmatex">\[ \{(m, n) \rightarrow (m \pm 1, n \pm 1) \mid m, n \in \mathbb{Z}\} \]</div>
<p>例如, 在第一步之后, 机器人可以处于状态 <span class="arithmatex">\((1, 1), (1, -1), (-1, 1)\)</span> 或
<span class="arithmatex">\((-1, -1)\)</span>. 在两步之后, 机器人有 9 种可能的状态, 包括 <span class="arithmatex">\((0, 0)\)</span>. 问题是,
机器人能否到达位置 <span class="arithmatex">\((1, 0)\)</span>？</p>
<p><img alt="" src="../images/clipboard-2907109516.png" /></p>
<p>如果你稍微玩一下这个机器人, 你可能会注意到机器人只能到达 <span class="arithmatex">\((m, n)\)</span>
的位置, 其中 <span class="arithmatex">\(m + n\)</span> 是偶数, 这当然意味着它不能到达 <span class="arithmatex">\((1, 0)\)</span>.</p>
<p>这可以解释为坐标和的偶性是由转换保持的属性. 这是一个保持不变性的例子.</p>
<p>这一次, 让我们仔细地通过这个保持不变性论证, 特别强调归纳法在其中的作用.
具体地, 定义状态的偶数和属性为：</p>
<div class="arithmatex">\[ \text{Even-sum}((m, n)) ::= [m + n \text{ 是偶数}] \]</div>
<div class="lem">
<h4 id="621_1">引理 6.2.1</h4>
<p>对于斜向移动机器人的任何转换 <span class="arithmatex">\(q \rightarrow r\)</span>, 如果
<span class="arithmatex">\(\text{Even-sum}(q)\)</span> 为真, 则 <span class="arithmatex">\(\text{Even-sum}(r)\)</span> 也为真.</p>
</div>
<p>该引理直接从机器人的转移定义得出：</p>
<div class="arithmatex">\[ (m, n) \rightarrow (m \pm 1, n \pm 1) \]</div>
<p>在转换后, 坐标和的变化是 <span class="arithmatex">\((\pm 1) + (\pm 1)\)</span>, 即 0, 2 或 -2. 当然, 将 0,
2 或 -2 加到一个偶数上得到一个偶数. 因此, 通过对转换次数的简单归纳法,
我们可以证明：</p>
<div class="thm">
<h4 id="622">定理 6.2.2</h4>
<p>斜向移动机器人可达的任何状态的坐标和是偶数.</p>
</div>
<div class="prf">
<p>证明是关于机器人所做的转换次数的归纳. 归纳假设是</p>
<div class="arithmatex">\[ P(n) ::= \text{如果 } q \text{ 是 } n \text{ 步可达状态, 则 } \text{Even-sum}(q) \]</div>
<p><strong>归纳基础：</strong> <span class="arithmatex">\(P(0)\)</span> 为真, 因为在 0 次转换中唯一可达的状态是初始状态
<span class="arithmatex">\((0, 0)\)</span>, 且 <span class="arithmatex">\(0 + 0\)</span> 是偶数.</p>
<p><strong>归纳步骤：</strong> 假设 <span class="arithmatex">\(P(n)\)</span> 为真, 设 <span class="arithmatex">\(r\)</span> 是 <span class="arithmatex">\(n + 1\)</span> 步可达的任意状态.
我们需要证明 <span class="arithmatex">\(\text{Even-sum}(r)\)</span> 成立.</p>
<p>由于 <span class="arithmatex">\(r\)</span> 是在 <span class="arithmatex">\(n + 1\)</span> 次转换中可达的, 必须存在一个状态 <span class="arithmatex">\(q\)</span> 在 <span class="arithmatex">\(n\)</span>
次转换中可达, 使得 <span class="arithmatex">\(q \rightarrow r\)</span>. 由于假设 <span class="arithmatex">\(P(n)\)</span> 为真,
<span class="arithmatex">\(\text{Even-sum}(q)\)</span> 成立, 因此由引理 6.2.1, <span class="arithmatex">\(\text{Even-sum}(r)\)</span>
也成立. 这证明了 <span class="arithmatex">\(P(n) \implies P(n + 1)\)</span> 如所需, 完成归纳步骤的证明.</p>
<p>因此, 我们通过归纳得出, 对于所有 <span class="arithmatex">\(n \geq 0\)</span>, 如果 <span class="arithmatex">\(q\)</span> 是在 <span class="arithmatex">\(n\)</span>
次转换中可达的状态, 则 <span class="arithmatex">\(\text{Even-sum}(q)\)</span> 成立.
这意味着每个可达状态都具有偶数和属性.</p>
</div>
<div class="cor">
<h4 id="623">推论 6.2.3</h4>
<p>机器人永远无法到达位置 <span class="arithmatex">\((1, 0)\)</span>.</p>
</div>
<div class="prf">
<p>根据定理 6.2.2, 我们知道机器人只能到达坐标和为偶数的位置, 因此它不能到达
<span class="arithmatex">\((1, 0)\)</span>.</p>
</div>
<h3 id="622_1">6.2.2 不变性原理的陈述</h3>
<p>使用偶数和不变量来理解斜向移动机器人是一个简单的示例,
说明了一种称为不变性原理的基本证明方法.
该原理总结了如何将到达状态的步骤数上的归纳应用于不变量.</p>
<p>状态机的执行描述了机器可能采取的步骤的可能序列.</p>
<div class="def">
<h4 id="624">定义 6.2.4</h4>
<p>状态机的执行是状态的（可能是无限的）序列, 具有以下属性：</p>
<ul>
<li>以初始状态开始, 并且</li>
<li>如果 <span class="arithmatex">\(q\)</span> 和 <span class="arithmatex">\(r\)</span> 是序列中的连续状态, 则 <span class="arithmatex">\(q \rightarrow r\)</span>.</li>
</ul>
</div>
<p>一个状态如果出现在某个执行中, 则称其为可达的.</p>
<div class="def">
<h4 id="625">定义 6.2.5</h4>
<p>状态机的保持不变性是对状态的谓词 <span class="arithmatex">\(P\)</span>, 使得每当 <span class="arithmatex">\(P(q)\)</span> 对状态 <span class="arithmatex">\(q\)</span> 成立且
<span class="arithmatex">\(q \rightarrow r\)</span> 对某个状态 <span class="arithmatex">\(r\)</span> 成立时, <span class="arithmatex">\(P(r)\)</span> 也成立.</p>
</div>
<div class="prop">
<h4 id="_1">不变性原理</h4>
<p>如果状态机的保持不变性对初始状态成立, 那么它对所有可达状态也成立.</p>
</div>
<p>不变性原理只不过是归纳原理在状态机中的便捷形式.
证明谓词在初始状态下为真是归纳的基准情况,
证明谓词是保持不变性对应于归纳步骤.</p>
<h3 id="623_1">6.2.3 《虎胆龙威》示例</h3>
<p>电影《虎胆龙威3》中包含了一个有趣的状态机示例. 由 Samuel L. Jackson 和
Bruce Willis 扮演的主角必须解除由邪恶的 Simon Gruber 安放的炸弹：</p>
<blockquote>
<p><strong>Simon:</strong> 在喷泉上, 应该有两个水壶,
看到了吗？一个5加仑和一个3加仑的水壶.
用其中一个水壶装满4加仑的水并放在秤上, 计时器就会停止.
你必须精确；多一盎司或少一盎司都会导致爆炸. 如果你在5分钟内还活着,
我们再说.</p>
<p><strong>Bruce:</strong> 等等, 我不明白. 你明白吗？</p>
<p><strong>Samuel:</strong> 不明白.</p>
<p><strong>Bruce:</strong> 拿起水壶. 显然, 我们不能用3加仑的水壶装4加仑的水.</p>
<p><strong>Samuel:</strong> 显然.</p>
<p><strong>Bruce:</strong> 好的, 我知道了, 我们把3加仑的水壶装满, 对吧？</p>
<p><strong>Samuel:</strong> 嗯.</p>
<p><strong>Bruce:</strong> 好了, 现在我们把这3加仑倒进5加仑的水壶,
这样5加仑的水壶里正好有3加仑的水, 对吧？</p>
<p><strong>Samuel:</strong> 对, 然后呢？</p>
<p><strong>Bruce:</strong> 好了, 我们把3加仑的水壶装满三分之一…</p>
<p><strong>Samuel:</strong> 不！他说“要精确”. 正好4加仑.</p>
<p><strong>Bruce:</strong> 哎… 每个50英里内的警察都在忙着, 而我在这里玩儿童游戏.</p>
<p><strong>Samuel:</strong> 嘿, 你想专注于手头的问题吗？</p>
</blockquote>
<p>幸运的是, 他们最终及时找到了解决方案. 你可以自己算出来.</p>
<h4 id="3">《虎胆龙威3》状态机</h4>
<p>水壶填充场景可以用状态机建模, 该状态机跟踪大水壶中的水量 <span class="arithmatex">\(b\)</span>
和小水壶中的水量 <span class="arithmatex">\(l\)</span>. 对于3加仑和5加仑的水壶, 状态形式上是实数对
<span class="arithmatex">\((b, l)\)</span>, 满足</p>
<div class="arithmatex">\[ 0 \leq b \leq 5, 0 \leq l \leq 3 \]</div>
<p>（我们可以证明 <span class="arithmatex">\(b\)</span> 和 <span class="arithmatex">\(l\)</span> 的可达值将是非负整数, 但我们不做这个假设.
）初始状态是 <span class="arithmatex">\((0, 0)\)</span>, 因为两个水壶都是空的.</p>
<p>由于水壶中的水量必须精确知道, 我们只考虑完全装满或完全倒空的操作.
有几种类型的转换：</p>
<ol>
<li>
<p>填满小水壶：<span class="arithmatex">\((b, l) \rightarrow (b, 3)\)</span> 对于 <span class="arithmatex">\(l &lt; 3\)</span></p>
</li>
<li>
<p>填满大水壶：<span class="arithmatex">\((b, l) \rightarrow (5, l)\)</span> 对于 <span class="arithmatex">\(b &lt; 5\)</span></p>
</li>
<li>
<p>倒空小水壶：<span class="arithmatex">\((b, l) \rightarrow (b, 0)\)</span> 对于 <span class="arithmatex">\(l &gt; 0\)</span></p>
</li>
<li>
<p>倒空大水壶：<span class="arithmatex">\((b, l) \rightarrow (0, l)\)</span> 对于 <span class="arithmatex">\(b &gt; 0\)</span></p>
</li>
<li>
<p>从小水壶倒入大水壶：对于 <span class="arithmatex">\(l &gt; 0\)</span>,</p>
<div class="arithmatex">\[
(b, l) \rightarrow \begin{cases} 
(b + l, 0) &amp; \text{如果 } b + l \leq 5, \\
(5, l - (5 - b)) &amp; \text{否则} 
\end{cases}
\]</div>
</li>
<li>
<p>从大水壶倒入小水壶：对于 <span class="arithmatex">\(b &gt; 0\)</span>,</p>
<div class="arithmatex">\[
(b, l) \rightarrow \begin{cases} 
(0, b + l) &amp; \text{如果 } b + l \leq 3, \\
(b - (3 - l), 3) &amp; \text{否则}
\end{cases}
\]</div>
</li>
</ol>
<p>请注意, 与99计数器状态机不同, 上述机器中的状态有多种可能的转换.
具有每个状态最多一个转换的机器称为确定性状态机. 上述机器是非确定性的,
因为某些状态有多种转换到不同的状态.</p>
<p>Die Hard 3中的炸弹成功解除, 因为状态 <span class="arithmatex">\((4, 3)\)</span> 是可达的.</p>
<h4 id="_2">永远的《虎胆龙威》</h4>
<p>Die Hard 系列已经让人疲惫, 所以我们提出一个最终的《虎胆龙威：永远》.
在这里, Simon 的兄弟回来为他报仇, 提出相同的挑战,
但用9加仑的水壶代替5加仑的水壶. 状态机与Die Hard 3版本相同,
只是所有出现的“5”都被替换为“9”.</p>
<p>现在, 到达 <span class="arithmatex">\((4, l)\)</span> 状态是不可能的. 我们使用不变性原理证明这一点.
具体来说, 我们定义保持不变谓词 <span class="arithmatex">\(P((b, l))\)</span> 为 <span class="arithmatex">\(b\)</span> 和 <span class="arithmatex">\(l\)</span>
是3的非负整数倍.</p>
<p>要证明 <span class="arithmatex">\(P\)</span> 是Die-Hard-Once-and-For-All机器的保持不变性, 我们假设 <span class="arithmatex">\(P(q)\)</span>
对某状态 <span class="arithmatex">\(q ::= (b, l)\)</span> 成立, 并且 <span class="arithmatex">\(q \rightarrow r\)</span>. 我们必须证明
<span class="arithmatex">\(P(r)\)</span> 成立. 证明根据使用的转换规则分成几种情况.</p>
<p>一种情况是“填满小水壶”转换. 这意味着 <span class="arithmatex">\(r = (b, 3)\)</span>. 但 <span class="arithmatex">\(P(q)\)</span> 意味着 <span class="arithmatex">\(b\)</span>
是3的整数倍, 当然3也是3的整数倍, 因此 <span class="arithmatex">\(P(r)\)</span> 仍然成立.</p>
<p>另一种情况是“从大水壶倒入小水壶”转换. 对于小水壶不能装下所有水的子情况,
即当 <span class="arithmatex">\(b + l &gt; 3\)</span> 时, 我们有 <span class="arithmatex">\(r = (b - (3 - l), 3)\)</span>. 但 <span class="arithmatex">\(P(q)\)</span> 意味着 <span class="arithmatex">\(b\)</span>
和 <span class="arithmatex">\(l\)</span> 是3的整数倍, 这意味着 <span class="arithmatex">\(b - (3 - l)\)</span> 也是3的整数倍,
因此在这种情况下, <span class="arithmatex">\(P(r)\)</span> 也成立.</p>
<p>我们不会详细讨论剩余的情况, 它们同样容易验证. 根据不变性原理,
我们得出每个可达状态都满足 <span class="arithmatex">\(P\)</span>. 但由于没有形式为 <span class="arithmatex">\((4, l)\)</span> 的状态满足
<span class="arithmatex">\(P\)</span>, 我们严格地证明了 Bruce 最终会死去！</p>
<p>顺便说一下, 注意到状态 <span class="arithmatex">\((1, 0)\)</span> 满足 <span class="arithmatex">\(\text{NOT}(P)\)</span>, 有一个转换到
<span class="arithmatex">\((0, 0)\)</span> 满足 <span class="arithmatex">\(P\)</span>. 所以, 保持不变性的否定可能不是保持不变性.</p>
<h2 id="63">6.3 部分正确性和终止性</h2>
<p>Floyd 区分了验证程序所需的两个属性.
第一个属性称为<strong>部分正确性</strong>；这是指过程的最终结果（如果有的话）必须满足系统要求.</p>
<p>你可能认为, 如果一个结果只是部分正确, 那么它可能也是部分不正确, 但这不是
Floyd 的意思. “部分”一词来源于将可能不会终止的过程视为计算部分关系.
部分正确性意味着<strong>当有结果时</strong>, 它是正确的, 但过程可能并不总是产生结果,
可能是因为它陷入了循环.</p>
<p>第二个正确性属性称为<strong>终止性</strong>, 即过程总是会产生某个最终值.</p>
<p>部分正确性通常可以使用不变性原理来证明.
终止性通常可以使用良序原理来证明.
我们将通过验证一个快速幂过程来说明这一点.</p>
<h3 id="631">6.3.1 快速幂</h3>
<p>最直接的计算一个数 <span class="arithmatex">\(a\)</span> 的 <span class="arithmatex">\(b\)</span> 次幂的方法是将 <span class="arithmatex">\(a\)</span> 自乘 <span class="arithmatex">\(b - 1\)</span> 次.
但使用一种称为快速幂的方法可以通过相当少的乘法次数找到解决方案.
下面的变量机器程序定义了快速幂算法. 字母 <span class="arithmatex">\(x, y, z, r\)</span>
表示存储数字的变量. 赋值语句的形式是“<span class="arithmatex">\(z := a\)</span>”并具有将变量 <span class="arithmatex">\(z\)</span>
中的数字设置为 <span class="arithmatex">\(a\)</span> 的效果.</p>
<div class="prop">
<h4 id="_3">快速幂程序</h4>
<p>给定输入 <span class="arithmatex">\(a \in \mathbb{R}, b \in \mathbb{N}\)</span>, 将变量 <span class="arithmatex">\(x, y, z\)</span> 初始化为
<span class="arithmatex">\(a, 1, b\)</span> 分别, 并重复以下步骤直到终止：</p>
<ul>
<li>如果 <span class="arithmatex">\(z = 0\)</span>, 返回 <span class="arithmatex">\(y\)</span> 并终止</li>
<li><span class="arithmatex">\(r := \text{remainder}(z, 2)\)</span></li>
<li><span class="arithmatex">\(z := \text{quotient}(z, 2)\)</span></li>
<li>如果 <span class="arithmatex">\(r = 1\)</span>, 那么 <span class="arithmatex">\(y := xy\)</span></li>
<li><span class="arithmatex">\(x := x^2\)</span></li>
</ul>
</div>
<p>我们声称这个程序总是终止并使 <span class="arithmatex">\(y = a^b\)</span>. 首先,
我们将用状态机对程序的行为进行建模：</p>
<ol>
<li>
<p><span class="arithmatex">\(\text{states} ::= \mathbb{R} \times \mathbb{R} \times \mathbb{N}\)</span></p>
</li>
<li>
<p><span class="arithmatex">\(\text{start state} ::= (a, 1, b)\)</span></p>
</li>
<li>
<p>转换由以下规则定义</p>
<div class="arithmatex">\[
(x, y, z) \rightarrow 
\begin{cases} 
(x^2, y, \text{quotient}(z, 2)) &amp; \text{如果 } z \text{ 是非零偶数}, \\
(x^2, xy, \text{quotient}(z, 2)) &amp; \text{如果 } z \text{ 是非零奇数}
\end{cases}
\]</div>
</li>
</ol>
<p>保持不变性 <span class="arithmatex">\(P((x, y, z))\)</span> 将是</p>
<div class="arithmatex">\[ z \in \mathbb{N} \text{ 且 } y x^z = a^b \tag{6.1} \]</div>
<p>要证明 <span class="arithmatex">\(P\)</span> 被保持, 假设 <span class="arithmatex">\(P((x, y, z))\)</span> 成立, 并且
<span class="arithmatex">\((x, y, z) \rightarrow (x_t, y_t, z_t)\)</span>. 我们必须证明
<span class="arithmatex">\(P((x_t, y_t, z_t))\)</span> 成立, 即</p>
<div class="arithmatex">\[ z_t \in \mathbb{N} \text{ 且 } y_t x_t^{z_t} = a^b \tag{6.2} \]</div>
<p>由于存在从 <span class="arithmatex">\((x, y, z)\)</span> 到 <span class="arithmatex">\((x_t, y_t, z_t)\)</span> 的转换, 我们有 <span class="arithmatex">\(z \neq 0\)</span>,
并且由于 <span class="arithmatex">\(z \in \mathbb{N}\)</span> 根据 (6.1), 我们可以考虑两种情况：</p>
<p>如果 <span class="arithmatex">\(z\)</span> 是偶数, 那么我们有 <span class="arithmatex">\(x_t = x^2, y_t = y, z_t = z / 2\)</span>. 因此,
<span class="arithmatex">\(z_t \in \mathbb{N}\)</span> 并且</p>
<div class="arithmatex">\[
\begin{aligned}
y_t x_t^{z_t} &amp;= y (x^2)^{z/2} \\
&amp;= y x^{2 \cdot z/2} \\
&amp;= y x^z \\
&amp;= a^b \quad \text{(由 (6.1))}
\end{aligned}
\]</div>
<p>如果 <span class="arithmatex">\(z\)</span> 是奇数, 那么我们有 <span class="arithmatex">\(x_t = x^2, y_t = xy, z_t = (z - 1) / 2\)</span>.
因此, <span class="arithmatex">\(z_t \in \mathbb{N}\)</span> 并且</p>
<div class="arithmatex">\[
\begin{aligned}
y_t x_t^{z_t} &amp;= xy (x^2)^{(z - 1)/2} \\
&amp;= xy x^{2 \cdot (z - 1)/2} \\
&amp;= xy x^{z - 1} \\
&amp;= y x^z \\
&amp;= a^b \quad \text{(由 (6.1))}
\end{aligned}
\]</div>
<p>所以在这两种情况下, (6.2) 成立, 证明了 <span class="arithmatex">\(P\)</span> 是保持不变的.</p>
<p>现在很容易证明部分正确性：如果快速幂程序终止, 它在变量 <span class="arithmatex">\(y\)</span> 中留下 <span class="arithmatex">\(a^b\)</span>.
这是成立的, 因为 <span class="arithmatex">\(1 \cdot a^b = a^b\)</span>, 这意味着初始状态 <span class="arithmatex">\((a, 1, b)\)</span> 满足
<span class="arithmatex">\(P\)</span>. 根据不变性原理, <span class="arithmatex">\(P\)</span> 对所有可达状态成立. 但是程序仅在 <span class="arithmatex">\(z = 0\)</span>
时停止. 如果终止状态 <span class="arithmatex">\((x, y, 0)\)</span> 是可达的, 那么 <span class="arithmatex">\(y = y \cdot x^0 = a^b\)</span>
如所需.</p>
<p>好的, 它是部分正确的, 但为什么说它快呢？答案是它计算 <span class="arithmatex">\(a^b\)</span>
的乘法次数大约是 <span class="arithmatex">\(b\)</span> 的二进制表示的长度. 即, 快速幂程序使用大约 <span class="arithmatex">\(\log b\)</span>
次方的乘法, 相比于通过 <span class="arithmatex">\(a\)</span> 总共乘 <span class="arithmatex">\(b - 1\)</span> 次的天真方法.</p>
<p>更确切地说, 快速幂算法计算 <span class="arithmatex">\(a^b\)</span> 的最多需要
<span class="arithmatex">\(2(\lfloor \log b \rfloor + 1)\)</span> 次乘法对于 <span class="arithmatex">\(b &gt; 1\)</span>. 原因是变量 <span class="arithmatex">\(z\)</span>
中的数字最初是 <span class="arithmatex">\(b\)</span>, 并且每次转换至少减半一次. 因此, 在到达零之前不能超过
<span class="arithmatex">\(\lfloor \log b \rfloor + 1\)</span> 次. 因此对于 <span class="arithmatex">\(b &gt; 0\)</span>,
每次转换最多涉及两次乘法, 直到 <span class="arithmatex">\(z = 0\)</span> 的时候, 总乘法次数最多是
<span class="arithmatex">\(2(\lfloor \log b \rfloor + 1)\)</span> （见问题 6.6）.</p>
<h3 id="632">6.3.2 导出变量</h3>
<p>前面的终止证明涉及找到一个非负整数值度量来分配给状态.
我们可以称这个度量为状态的“大小”.
然后我们证明状态的大小随着每次状态转换而减小. 根据良序原理,
大小不能无限减小, 所以当达到最小大小状态时, 不可能有转换：过程终止.</p>
<p>更一般地, 将值分配给状态的技术——不一定是非负整数,
并且不一定在转换下减少——在算法分析中通常很有用.
势函数在物理中起着类似的作用. 在计算过程的背景下,
这种状态的值分配称为导出变量.</p>
<p>例如, 对于《虎胆龙威》机器, 我们可以引入一个导出变量
<span class="arithmatex">\(f : \text{states} \rightarrow \mathbb{R}\)</span>, 表示两个水壶中的水量,
通过设置</p>
<div class="arithmatex">\[ f((a, b)) ::= a + b \]</div>
<p>类似地, 在机器人问题中, 机器人沿 <span class="arithmatex">\(x\)</span> 轴的位置由导出变量 <span class="arithmatex">\(x\)</span>-坐标给出,
其中</p>
<div class="arithmatex">\[ x\text{-coord}((i, j)) ::= i \]</div>
<p>有几种标准属性的导出变量在分析状态机时很有用.</p>
<div class="def">
<h4 id="631_1">定义 6.3.1</h4>
<p>如果 <span class="arithmatex">\(q \rightarrow q' \implies f(q') &lt; f(q)\)</span>, 则导出变量
<span class="arithmatex">\(f : \text{states} \rightarrow \mathbb{R}\)</span> 严格递减.</p>
<p>如果 <span class="arithmatex">\(q \rightarrow q' \implies f(q') \leq f(q)\)</span>, 则它是弱递减的.</p>
<p>严格递增和弱递增导出变量的定义类似.</p>
</div>
<p>我们通过注意到导出变量 <span class="arithmatex">\(z\)</span> 是非负整数值和严格递减的,
证实了快速幂过程的终止性. 我们可以总结这种证明终止性的方法如下：</p>
<div class="thm">
<h4 id="632_1">定理 6.3.2</h4>
<p>如果 <span class="arithmatex">\(f\)</span> 是状态机的严格递减 ( <span class="arithmatex">\(\mathbb{N}\)</span> ) 值导出变量, 那么从状态 <span class="arithmatex">\(q\)</span>
开始的任何执行的长度最多为 <span class="arithmatex">\(f(q)\)</span>.</p>
</div>
<p>当然, 我们可以通过对 <span class="arithmatex">\(f(q)\)</span> 的值进行归纳证明定理 6.3.2,
但想想它的意义：<strong>如果你从某个状态下降到某个非负整数值</strong> <span class="arithmatex">\(f(q)\)</span>,
那么你最多只能下降 <span class="arithmatex">\(f(q)\)</span> 次. 换句话说, 这显而易见.</p>
<h3 id="633">6.3.3 使用良序集的终止性（可选）</h3>
<p>定理 6.3.2 自然推广到取值于良序集的导出变量（见第2.4节）.</p>
<div class="thm">
<p>定理 6.3.3 如果存在一个严格递减的导出变量, 其范围是良序集,
那么每个执行都终止.</p>
</div>
<p>定理 6.3.3 立即得出一个数集是良序的观察结果,
即如果它没有无限递减序列（问题2.23）.</p>
<p>注意, 弱递减导出变量的存在并不保证每个执行都终止.
无限执行可能通过状态进行, 其中弱递减变量保持不变.</p>
<h3 id="634">6.3.4 向东南跳跃的机器人（可选）</h3>
<p>这是一个简单的、人为的终止性证明示例, 基于一个在良序集上严格递减的变量.
让我们考虑一个在非负整数象限 <span class="arithmatex">\(\mathbb{N}^2\)</span> 中旅行的机器人.</p>
<p>如果机器人在某个位置 <span class="arithmatex">\((x, y)\)</span> 不同于原点 <span class="arithmatex">\((0, 0)\)</span>, 则机器人必须移动,
可以是</p>
<ul>
<li>向西移动一个单位距离——即 <span class="arithmatex">\((x, y) \rightarrow (x - 1, y)\)</span> 对于
    <span class="arithmatex">\(x &gt; 0\)</span>, 或</li>
<li>向南移动一个单位距离, 结合任意向东跳跃——即
    <span class="arithmatex">\((x, y) \rightarrow (z, y - 1)\)</span> 对于 <span class="arithmatex">\(z \geq x\)</span>,</li>
</ul>
<p>前提是移动不离开第一象限.</p>
<div class="prop">
<h4 id="634_1">命题 6.3.4</h4>
<p>机器人将总是卡在原点.</p>
</div>
<p>如果我们将机器人视为一个非确定性状态机, 那么命题 6.3.4 是一个终止断言.
该命题看起来很明显, 但它确实与基于非负整数值变量的终止有很大不同.
这是因为, 即使知道机器人在位置 <span class="arithmatex">\((0, 1)\)</span>, 也无法限制机器人卡住所需的时间.
它可以延迟卡住, 只要它想把下一个移动到远东. 因此, 这排除了使用定理 6.3.2
证明终止性.</p>
<p>那么命题 6.3.4 仍然看起来明显吗？</p>
<p>如果你看到了诀窍, 那是显而易见的. 定义一个导出变量 <span class="arithmatex">\(\nu\)</span>
将机器人状态映射到引理 2.4.6 中的良序集 <span class="arithmatex">\(\mathbb{N} + \mathbb{F}\)</span>.
具体地, 定义</p>
<div class="arithmatex">\[ \nu(x, y) ::= y + \frac{x}{x + 1} \]</div>
<p>现在很容易检查, 如果 <span class="arithmatex">\((x, y) \rightarrow (x', y')\)</span>
是一个合法的机器人移动, 那么 <span class="arithmatex">\(\nu((x', y')) &lt; \nu((x, y))\)</span>. 特别地,
<span class="arithmatex">\(\nu\)</span> 是一个严格递减的导出变量, 所以定理 6.3.3
表明机器人总是会卡住——尽管我们不能说它会花多少步才能卡住.</p>
<h3 id="64">6.4 稳定婚姻问题</h3>
<p>假设我们有一群男人和女人,
每个人都有他们希望结婚的异性对象的偏好：每个男人都有所有女人的喜好列表,
每个女人也有所有男人的喜好列表.</p>
<p>这些偏好不必是对称的. 也就是说, Jennifer 可能最喜欢 Brad, 但 Brad
不一定最喜欢 Jennifer. 目标是让每个人都结婚：每个男人必须恰好娶一个女人,
反之亦然——没有一夫多妻制和异性婚姻. 此外,
我们希望找到一个男人和女人之间的匹配, 这种匹配是稳定的,
意味着没有一对人更喜欢彼此而不是他们的配偶.</p>
<p>例如, 假设 Brad 最喜欢 Angelina, Angelina 最喜欢 Brad, 但 Brad 和
Angelina 都与其他人结婚, 例如 Jennifer 和 Billy Bob. 现在 Brad 和
Angelina 更喜欢彼此而不是他们的配偶, 这使得他们的婚姻处于危险之中. 很快,
他们可能会开始在深夜一起工作问题集！</p>
<p>一般来说, 在任何匹配中,
一个男人和一个女人如果彼此喜欢对方超过他们的配偶, 则被称为“流氓夫妇”.
在图 6.4 中, Brad 和 Angelina 将是一个流氓夫妇.</p>
<p><img alt="" src="../images/clipboard-446697309.png" /></p>
<p>拥有流氓夫妇不是一件好事, 因为它威胁到婚姻的稳定性. 另一方面,
如果没有流氓夫妇, 那么对于任何不相互结婚的男人和女人,
至少有一个人喜欢他们的配偶超过对方,
因此不会有任何相互诱惑去开始一段婚外情.</p>
<div class="def">
<h4 id="641">定义 6.4.1</h4>
<p>稳定匹配是没有流氓夫妇的匹配.</p>
</div>
<p>问题是, 考虑到每个人的偏好, 你能找到一组稳定的婚姻吗？在仅由图 6.4
中的四个人组成的示例中, 我们可以让 Brad 和 Angelina
都拥有他们的第一选择, 彼此结婚. 现在, Brad 和 Angelina
都不喜欢其他人超过他们的配偶, 因此都不会成为流氓夫妇. 这使得 Jen
不那么高兴地嫁给 Billy Bob, 但 Jen 和 Billy Bob
都不能吸引其他人嫁给他们, 因此这是一个稳定的匹配.</p>
<p>事实证明, 总是存在一组男人和女人的稳定匹配.
我们不知道任何立即识别这种匹配的方法, 这看起来令人惊讶. 事实上,
在表面上类似的“朋友”匹配问题中, 稳定匹配可能并不总是可能的. 在问题 6.22
中给出了一个四个人的偏好示例, 其中没有稳定的朋友匹配. 但是,
当男人只能娶女人, 女人只能嫁给男人时, 有一个简单的程序可以生成稳定匹配,
并且保持不变性的概念提供了一种优雅的方式来理解和验证该程序.</p>
<h3 id="641_1">6.4.1 求偶仪式</h3>
<p>找到稳定匹配的过程可以通过一种令人难忘的方式描述为一个求偶仪式,
历时数天. 在开始的那天, 每个男人都有他所有女人的完整偏好列表,
同样每个女人也有她所有男人的完整偏好列表. 然后每天发生以下事件：</p>
<p><strong>早晨：</strong> 每个男人站在他偏好列表顶部的女人的阳台下,
这是他在所有其他剩余女人中最喜欢的, 然后他为她唱小夜曲.
他被称为她的追求者. 如果一个男人没有剩下的女人可选,
他就呆在家里做数学作业.</p>
<p><strong>下午：</strong>
每个有一个或多个追求者的女人对她们中最喜欢的一个说：“我们可能会订婚.
请留步.” 对其他追求者, 她说：“不, 我永远不会嫁给你！滚开！”</p>
<p><strong>晚上：</strong> 任何被女人拒绝的男人在他的偏好列表上划掉该女人.</p>
<p><strong>终止条件：</strong> 当到达某天时, 每个女人最多只有一个追求者, 仪式结束,
每个女人与她的追求者结婚（如果她有的话）.</p>
<p>关于这个求偶仪式, 我们想证明的事实有很多：</p>
<ul>
<li>仪式最终达到终止条件.</li>
<li>每个人最终都结婚了.</li>
<li>结果婚姻是稳定的.</li>
</ul>
<p>为了证明这些事实, 认识到这个仪式是状态机的描述会很有帮助.
一天开始时的状态由知道每个男人在那一天将为其唱小夜曲的女人（如果有的话）确定——即他在前几天划掉所有拒绝他的女人后在其偏好列表顶部的女人.</p>
<h3 id="642">6.4.2 婚礼日</h3>
<p>很容易看出为什么求偶仪式有一个终止日, 当人们终于结婚的那一天. 每一天,
如果仪式没有终止, 至少有一个男人将一个女人从他的列表中划掉.
（如果仪式没有终止, 必须有一个女人被至少两个男人追求,
且至少一个男人将不得不将她从他的列表中划掉）. 如果我们从 <span class="arithmatex">\(n\)</span> 个男人和
<span class="arithmatex">\(n\)</span> 个女人开始, 那么每个男人的列表最初有 <span class="arithmatex">\(n\)</span> 个女人, 总共有 <span class="arithmatex">\(n^2\)</span>
个列表条目. 由于没有女人会被添加到列表中,
所以列表上的总条目数每天都在减少, 因此仪式最多可以持续 <span class="arithmatex">\(n^2\)</span> 天.</p>
<h3 id="643">6.4.3 他们从此幸福地生活下去…</h3>
<p>我们将证明求偶仪式使每个人都婚姻稳定. 为此,
我们注意到仪式的一个非常有用的事实：如果某天早上一个女人有追求者,
那么她最喜欢的追求者明天早上仍然会为她唱小夜曲——他的列表不会改变. 因此,
她肯定会在明天的追求者中找到今天最喜欢的追求者.
这意味着她将能够在明天选择一个她喜欢的追求者,
而这个追求者今天同样对她有吸引力. 所以她每天的最爱都在变好或不变.
这听起来像是不变性, 所以我们将其形式化.</p>
<div class="lem">
<h4 id="642_1">引理 6.4.2</h4>
<p>对于每个女人 <span class="arithmatex">\(w\)</span> 和男人 <span class="arithmatex">\(m\)</span>, 如果 <span class="arithmatex">\(w\)</span> 被划掉 <span class="arithmatex">\(m\)</span> 的列表, 那么 <span class="arithmatex">\(w\)</span>
有一个她喜欢的追求者胜过 <span class="arithmatex">\(m\)</span>.</p>
</div>
<div class="prf">
<p>只有当女人 <span class="arithmatex">\(w\)</span> 有一个她更喜欢的追求者时, 女人 <span class="arithmatex">\(w\)</span> 才会从男人 <span class="arithmatex">\(m\)</span>
的列表中划掉. 从那时起, 她最喜欢的追求者不会改变,
直到出现一个她更喜欢的人. 所以如果她最喜欢的追求者胜过 <span class="arithmatex">\(m\)</span>,
那么任何新的最喜欢的追求者也将胜过 <span class="arithmatex">\(m\)</span>.</p>
</div>
<p>注意, 开始时没有女人被划掉, 所以不变性 <span class="arithmatex">\(P\)</span> 在开始时是空洞成立的. 因此,
根据不变性原理, <span class="arithmatex">\(P\)</span> 在整个仪式过程中成立. 现在我们可以证明：</p>
<div class="thm">
<h4 id="643_1">定理 6.4.3</h4>
<p>在求偶仪式结束时每个人都结婚.</p>
</div>
<div class="prf">
<p>假设相反, 在求偶仪式的最后一天, 有某个男人——称他为 Bob——没有结婚.
这意味着 Bob 没有为任何女人唱小夜曲, 因此他的列表是空的.
所以每个女人必须已经从他的列表中划掉, 并且由于 <span class="arithmatex">\(P\)</span> 为真,
每个女人都有一个她更喜欢的追求者. 因此, 特别是每个女人都有追求者,
因为这是最后一天, 她们只有一个追求者, 而这正是她们嫁的人.
但有相同数量的男人和女人, 所以如果所有女人都结婚, 那么所有男人也都结婚,
这与假设 Bob 未婚相矛盾.</p>
</div>
<div class="thm">
<h4 id="644">定理 6.4.4</h4>
<p>求偶仪式产生一个稳定的匹配.</p>
</div>
<div class="prf">
<p>证明. 假设 Brad 和 Jen 分别是任何一个男人和女人,
他们在求偶仪式的最后一天没有结婚. 我们将证明 Brad 和 Jen 不是流氓夫妇,
因此最后一天的所有婚姻都是稳定的. 有两种情况需要考虑.</p>
<p><strong>情况 1:</strong> Jen 在最后没有出现在 Brad 的列表上. 那么根据不变性 <span class="arithmatex">\(P\)</span>,
我们知道 Jen 有一个追求者（因此也是丈夫）, 她比 Brad 更喜欢.
因此她不会与 Brad 私奔——Brad 和 Jen 不能是流氓夫妇.</p>
<p><strong>情况 2:</strong> Jen 出现在 Brad 的列表上. 由于 Brad
选择向女人唱小夜曲时是按列表顺序进行的,
他的妻子在他偏好列表中的位置一定比 Jen 高. 因此他不会与 Jen 私奔——Brad
和 Jen 不能是流氓夫妇.</p>
</div>
<h3 id="644_1">6.4.4 …特别是男人</h3>
<p>求偶仪式偏向男人还是女人？女人似乎拥有所有的权力：每天她们选择最喜欢的追求者,
拒绝其他人. 更重要的是,
我们知道她们的追求者在仪式进行过程中只会变得越来越好. 类似地,
一个男人会一直为他最喜欢的女人唱小夜曲, 直到他必须将她划掉,
此时他会为他列表中下一个最喜欢的女人唱小夜曲. 从男人的角度来看,
他所追求的女人只会变得越来越差. 这对女人来说似乎是个好事.</p>
<p>但事实并非如此！我们将证明在求偶仪式中男人是最受偏爱的性别.</p>
<p>虽然求偶仪式产生一个稳定的匹配, 但稳定匹配可能不唯一. 例如,
颠倒男人和女人的角色通常会在他们之间产生不同的稳定匹配. 因此,
一个男人在不同的稳定婚姻中可能有不同的妻子. 在某些情况下,
一个男人可以稳定地娶到所有女人中的每一个, 但在大多数情况下,
有些女人不能成为男人在任何稳定婚姻中的妻子. 例如, 考虑图 6.4 中的偏好,
Jennifer 不可能是 Brad 在任何稳定匹配中的妻子, 因为如果她与他结婚,
那么他和 Angelina 将是一个流氓夫妇.</p>
<div class="def">
<h4 id="645">定义 6.4.5</h4>
<p>给定男人和女人的偏好集, 当在一个稳定匹配中这两个人结婚时,
一个人是另一个人的可行配偶.</p>
</div>
<div class="def">
<h4 id="646">定义 6.4.6</h4>
<p>令 <span class="arithmatex">\(Q\)</span> 为谓词：对于每个女人 <span class="arithmatex">\(w\)</span> 和男人 <span class="arithmatex">\(m\)</span>, 如果 <span class="arithmatex">\(w\)</span> 被划掉 <span class="arithmatex">\(m\)</span> 的列表,
那么 <span class="arithmatex">\(w\)</span> 不是 <span class="arithmatex">\(m\)</span> 的可行配偶.</p>
</div>
<div class="lem">
<h4 id="647">引理 6.4.7</h4>
<p><span class="arithmatex">\(Q\)</span> 是求偶仪式的一个保持不变性.</p>
</div>
<div class="prf">
<p>假设 <span class="arithmatex">\(Q\)</span> 在仪式的某个时刻成立, 并且某个女人 Alice 正要被划掉某个男人 Bob
的列表. 我们声称 Alice 不能是 Bob 的可行配偶. 因此 <span class="arithmatex">\(Q\)</span> 在 Alice
被划掉后仍然成立, 证明了 <span class="arithmatex">\(Q\)</span> 是不变的.</p>
<p>为了验证这一点, 请注意当 Alice 被划掉 Bob 的列表时, 是因为 Alice
有一个她比 Bob 更喜欢的追求者. 更重要的是, 由于 <span class="arithmatex">\(Q\)</span> 成立, Ted
的所有可行配偶仍在他的列表上, 并且 Alice 排在顶部. 所以 Ted
比他所有其他可行配偶更喜欢 Alice. 现在, 如果 Alice
可以在某个稳定婚姻集中与 Bob 结婚, 那么 Ted 必须与一个他不如 Alice
喜欢的妻子结婚, 这使得 Alice 和 Ted 成为一个流氓夫妇, 违背了稳定性. 因此
Alice 不能与 Bob 结婚, 即 Alice 不是 Bob 的可行妻子.</p>
</div>
<div class="def">
<h4 id="648">定义 6.4.8</h4>
<p>给定男人和女人的偏好集, 一个人的最优配偶是他们最喜欢的可行配偶.
一个人的最差配偶是他们最不喜欢的可行配偶.</p>
</div>
<p>每个人都有一个最优和最差配偶, 因为我们知道至少有一个稳定匹配,
即由求偶仪式产生的那个. 引理 6.4.7 暗示了求偶仪式的一个关键属性：</p>
<div class="thm">
<h4 id="649">定理 6.4.9</h4>
<p>求偶仪式让每个男人都娶到了他的最优妻子.</p>
</div>
<div class="prf">
<p>如果 Bob 在仪式的最后一天与 Alice 结婚, 那么 Bob 的偏好列表上 Alice
以上的所有女人都被划掉了, 根据 <span class="arithmatex">\(Q\)</span> 性质, 这些被划掉的女人对 Bob
来说都是不可行的. 因此 Alice 是 Bob 排名最高的可行配偶, 即他的最优妻子.</p>
</div>
<div class="cor">
<h4 id="6411">推论 6.4.11</h4>
<p>求偶仪式让每个女人都嫁给了她的最差丈夫.</p>
</div>
<h3 id="645_1">6.4.5 应用</h3>
<p>求偶仪式首次发表于 D. Gale 和 L.S. Shapley 的一篇论文中, 发表于1962年,
但在 Gale-Shapley 论文发表的十年前, 他们未知的是,
一个类似的算法正在被用于将住院医生分配到医院,
由国家住院医生匹配计划（NRMP）使用. 自20世纪初以来,
NRMP每年将医学院毕业生分配到医院实习（通常称为“实习”）,
医院和毕业生扮演男人和女人的角色. 在采用类似仪式的算法之前,
为了保持不稳定的毕业生分配到实习, 存在长期的混乱和尴尬的对策.
仪式如此成功地解决了这些问题, 以至于在1989年之前, 几乎没有改变.
由于这项及相关工作, Shapley 在2012年获得了诺贝尔经济学奖.</p>
<p>不出所料, 求偶仪式也被至少一个大型在线约会机构使用. 当然,
没有小夜曲的表演——一切都由计算机处理.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["toc.integrate", "navigation.sections", "navigation.tabs", "navigation.sections", "navigation.top", "navigation.tracking", "search.suggest", "search.highlight", "contents.tabs.link", "contents.code.annotation", "contents.code.copy", "toc.follow"], "search": "../../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.471ce7a9.min.js"></script>
      
        <script src="../../../javascripts/solfold.js"></script>
      
        <script src="../../../javascripts/config.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>